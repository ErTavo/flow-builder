{
      "structure": {
    "entry": "init",
    "states": [
      {
        "key": "bh-close",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "<<CLOSE>>"
            }
          }
        ],
        "transitions": [],
        "transition_delay": -1
      },
      {
        "key": "init",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "script-validate-first-time",
            "type": "auto",
            "delay": 0,
            "variable_replace": {
              "slug": "san-martin",
              "baseURL": "https://ye86lyi5w5.execute-api.us-east-1.amazonaws.com/prod",
              "timezone": "America/Guatemala",
              "genericYalu": "https://generic-middleware.yalutec.app",
              "webviewBase": "https://webview.yumpii.com/san-martin.ng?orderId={orderId}&userId={userId}"
            }
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "get-webview-parameters",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "",
            "type": "script",
            "delay": 0,
            "params": {
              "script": "yumpii-bot-middleware-prod-createOrder",
              "transitions": {
                "success": "webview-link"
              }
            },
            "position": 0
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "fallback-webview-parameters",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Disculpa, ocurri√≥ un error de conexi√≥n.\n"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Regresar"
                },
                {
                  "id": "string",
                  "title": "Hablar con asesor"
                }
              ],
              "bodyText": "Para volver a intentar por favor selecciona *regresar*. üòä",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "get-webview-parameters",
            "type": "contains",
            "value": "regresar|volver|atras|atr√°s|regresa|regresame|regr√©same|ver carta|ver men√∫|platillos|platos|precios|presios",
            "variable_replace": {}
          },
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|men√∫",
            "variable_replace": {}
          },
          {
            "next": "business-hours",
            "type": "contains",
            "value": "hablar con asesor|asesor|agente|hablar con alguien",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "webview-resume",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Este es el *resumen de tu pedido*:\n\n{{#each order.items}}\n\n{{this.quantity}} x {{this.product.name}} (Q{{this.subTotal}})\n{{#each this.product.customizations}}\n- {{this.title}}: {{#each this.options}}{{#if this.quantity}}{{this.title}}{{/if}}{{/each}}\n{{/each}}\n{{/each}}\n\n*Total: Q{{order.totalFormatted}}*"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "S√≠"
                },
                {
                  "id": "string",
                  "title": "No"
                }
              ],
              "bodyText": "¬øDeseas confirmar tu pedido? üòä\n\nSelecciona el bot√≥n *s√≠* para continuar o elige la opci√≥n *no* si deseas editarlo.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "order-comments",
            "type": "contains",
            "value": "si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|1|uno|one|va",
            "variable_replace": {}
          },
          {
            "next": "order-once-again",
            "type": "contains",
            "value": "no|nel|no!|nely|nelly|√±o|norton|negativo|malo|malo|mal|incorrecto|incorrecta|equivocado|equivocada|negative|bad|wrong|not|nay|√±ao|ruim|errado|incorreto",
            "variable_replace": {}
          },
          {
            "next": "e-script-send-order",
            "type": "contains",
            "value": "test-pedido",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "order-comments",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Si deseas ingresar un comentario extra a tu pedido escr√≠belo en *un s√≥lo mensaje* a continuaci√≥n.\n\n_(Ejemplo: agregar cubiertos y servilletas)_"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Continuar"
                }
              ],
              "bodyText": "Si no tienes ning√∫n comentario extra selecciona *continuar*. ‚ú®",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "ask-factura",
            "type": "contains",
            "value": "continuar|conitnue",
            "variable_replace": {}
          },
          {
            "next": "order-comments-fallback",
            "type": "contains",
            "value": "cabron|chinga|chingan|chingas|chingon|chingada|chingadas|jode|jodes|jodidos|jodiendo|jodo|kulero|mamadas|mames|mams|mamon|mierda|mierda|mierdas|ni madres|pendeja|pendeja|pendejas|pendejo|pendejo|pendejos|pinche|pinches|ptm|puta|puta|putos|hdp|culero|putero|fuck|asshole|rateros|ratas|joto|joterias|joterias|caca|kaka|cagado|cagados|huevon|huevones|wevones|webones|webon|wevon|idiota|esperma|sperma|vagina|menstruaci√≥n|sexo|pucha|puchita|panocha|panochon|nepe|pito|pitos|pitero|putero|putas|puterias|puterias|puto|ratas|shinga|shingas|shingon|shing√≥n|shit|spm|verga|hdp|cagar|cagas|chinga|chingas|chingada|chingado|chingadoo|chingalos|chingao|chingaos|chingar|chingarlos|chingarnos|chingarte|chingate|chingatelos|chingo|chingon|chinguen|ching√≥n|chingalos|chingate|chingatelos|cancer|cancer|orgullo.com|condon|condones|cond√≥n|cojon|cojon|culera|culeras|culero|culeros|culo|joder|madrear|mamada|mamadas|mamar|mamarracho|mamen|mames|mamez|mamon|mamon|maricon|maric√≥n|mierda|mojon|ogete|ogetes|ojete|ojetes|pedorro|pendeja|pendejada|pendejadas|pendejas|pendejo|pinche|pinches|pinga|pito|pitos|puta|putas|putisima|putisimas|putisimo|putisimos|puto|putos|putisima|putisimas|putisimo|putisimos|pu√±al|pu√±ales|pu√±etas|pu√±eta|shingaa|webo|webos|wevo|wevos|putazo|pendejo|pendeja|pendejos|pendejotes|pendejas|chingado|cabron|chinga|culera|mamar|mamen|kabron|jodido|pinches|pito|ratas|marika|rreputa|reputisima|cerote|punal|joder|idiota|estupido|est√∫pido|mierda|putos|porno|nudes|desnudo|desnudos|pendejos|torpe|tonto|mamar|chingada|malditos|maldito|pendejos|tarado|masturbar|masturbando|masturbaci√≥n|masturbacion|masturbasion|marturbame|masturbame|masturvando|masturvar|masturbandome|masturvandome|chaqueta|chaqueteando|jalando|jalondomela|jalandomela|masturbandome|pajiando|pajas|paja|mestruar|menstruacion|menstruacion|menstruasion|menstruasion|tengo la regla|me vino|me vine|sexo|sexual|porno|coger|cojer|cogida|cojida|semen|pene|culo|culos|ano|nalga|nalgas|seno|senos|chiche|chiches|chichi|chichis|pechos|tetas|ubres|teta|caca|orinar|fisting|tonta|mensa|pendeja|wawis|clitoris|cl√≠toris|panocha|bizcocho|biscocho|perra|zorra|chupamela|chupamela|chupamela|gorda",
            "variable_replace": {}
          },
          {
            "next": "ask-factura",
            "type": "regex",
            "value": "^(?=.{1,60}$)[\\w\\s√°√©√≠√≥√∫√Å√â√ç√ì√ö√±√ë√º√ú.-\\p{P}]+$",
            "variable_replace": {
              "orderComments": "{{context.userMessage.content.text}}"
            }
          },
          {
            "next": "ask-factura",
            "type": "regex",
            "value": "^(?=.{1,60}$)[\\w\\s√°√©√≠√≥√∫√Å√â√ç√ì√ö√±√ë√º√ú.,\\.\\#\\-\\_\\+\\;\\:\\&\\*\\=\\p{P}]+$",
            "variable_replace": {
              "orderComments": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "order-once-again",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°De acuerdo! Volvamos a iniciar tu pedido. üòä"
            }
          }
        ],
        "transitions": [
          {
            "next": "get-webview-parameters",
            "variable_replace": {}
          }
        ],
        "transition_delay": 2
      },
      {
        "key": "confirm-resume-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "No me qued√≥ clara tu respuesta. üòÖ \n\nEscribe *s√≠* para confirmar tu pedido o escribe *no* si deseas cambiar tu pedido."
            }
          }
        ],
        "transitions": [
          {
            "next": "order-comments",
            "type": "contains",
            "value": "si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|1|uno|one|va",
            "variable_replace": {}
          },
          {
            "next": "order-once-again",
            "type": "contains",
            "value": "no|nel|no!|nely|nelly|√±o|norton|negativo|malo|malo|mal|incorrecto|incorrecta|equivocado|equivocada|negative|bad|wrong|not|nay|√±ao|ruim|errado|incorreto",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "ask-factura",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "S√≠"
                },
                {
                  "id": "string",
                  "title": "No"
                }
              ],
              "bodyText": "¬øDeseas datos para tu factura? üßæ\n\nSelecciona *s√≠* para ingresarlos o selecciona *no* para continuar con _Consumidor Final_.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "ask-nit",
            "type": "contains",
            "value": "si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|va",
            "variable_replace": {
              "invoiceOption": "S√≠"
            }
          },
          {
            "next": "no-factura",
            "type": "contains",
            "value": "no|nel|no|nely|nelly|√±o|norton|consumidor final|cf|no (cf)",
            "variable_replace": {
              "invoiceNit": "CF",
              "invoiceOption": "No"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "ask-nit",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Bien, ahora ind√≠came en un s√≥lo mensaje tu *NIT*. üî¢\n\n_Ejemplo: 2311001 (sin gui√≥n)_"
            }
          }
        ],
        "transitions": [
          {
            "next": "ask-nit-copy",
            "type": "contains",
            "value": "new-nit",
            "variable_replace": {}
          },
          {
            "next": "validate-nit",
            "type": "regex",
            "value": "([u00C0-√ø0-9\\s\\-\\k\\K\\]|[/[0-9]{4,10})",
            "variable_replace": {
              "invoiceNit": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "no-factura",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "De acuerdo, tu factura estar√° como *Consumidor Final.* üòä"
            }
          }
        ],
        "transitions": [
          {
            "next": "save-invoice-info",
            "variable_replace": {}
          }
        ],
        "transition_delay": 2
      },
      {
        "key": "ask-factura-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Escribe *s√≠* si deseas datos para tu factura o escribe *no* si no deseas datos para tu factura. üßæüòä"
            }
          }
        ],
        "transitions": [
          {
            "next": "ask-nit",
            "type": "contains",
            "value": "si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|va",
            "variable_replace": {
              "invoiceOption": "S√≠"
            }
          },
          {
            "next": "no-factura",
            "type": "contains",
            "value": "no|nel|no|nely|nelly|√±o|norton",
            "variable_replace": {
              "invoiceOption": "No"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "payment-method",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Tarjeta üí≥"
                },
                {
                  "id": "string",
                  "title": "Efectivo  üíµ"
                }
              ],
              "bodyText": "Ahora, elige el m√©todo de pago.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "bh-migo",
            "type": "contains",
            "value": "uno|1|1Ô∏è‚É£|one|credito|tarjeta|cr√©dito|tarjeta de cr√©dito|targeta|targetas|debito|d√©bito|link|links",
            "variable_replace": {
              "userPaymentMethod": "Tarjeta"
            }
          },
          {
            "next": "cash-type",
            "type": "contains",
            "value": "dos|2|2Ô∏è‚É£|two|dois|doz|efectivo|cash|efektivo|Pago en restaurante|restaurante|cupon|vales|kupon|cup√≥n|vale",
            "variable_replace": {
              "userPaymentMethod": "Efectivo"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "ask-nombre-factura",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Ahora, ind√≠came el *nombre* que deseas en tu factura. üòä\n\nEscr√≠belo en una *sola l√≠nea*.\n\n_Ejemplo: Tu Empresa S.A.S. o Mi Negocio_"
            }
          }
        ],
        "transitions": [
          {
            "next": "ask-nombre-factura-fallback",
            "type": "contains",
            "value": "cerote|puta|idiota|est√∫pido|estupido|hijo de puta|indio|negro|chino|covid|coronavi|covid-19|coronavirus|navirus|donald trump|AMLO|Pe√±a Nieto|peje|Queso Plas|Rosa Melano|Susana Horia|Benito Camela|Elba Ginon|Elvis Tek|Aquiles Bailo|Susana Distancia|Mama Dora|Zacarias Leche|Carmelo Machuca|Miguel Ambes Parada|Meardel Peson|Lalo Onganiza|Carmelo Tallas|Zacarias Blanco|Aquiles Pico|Marisa Caleche|Carmela Rosas|Willy Melano|Zacarias Bello Delano|Zoyla Alegria Delano|Ana Lisa Melchotto|Memo Herdez|Virginia Del Hoyo Aguado|Zoyla cerda|Deborah Vergara|Lucio Elano|Mar√≠a Melo Machuca|Paca Gartela|Pachin Gartela|Maite Lometo|Rosa Melgorro|Esther Colero|Paco Gerlo|Elver Galarga|Dora Melcacho|Zoyla Vaca|Alberto Catetas|Paco Mermela|Alberto Caco√±os|Alberto Caculos|Alberto Capollas|Alberto Capitos|Deborah Melculo|Abraham Melculo|Elsa Pito|Paco Mermela|Cindy Nero|Alma Marcela Goza de Alegria|Jony Melavo|Elba Gina|Paco Jerte|Rosamel Delgado|Edgar Ganta|Lola Meraz|Olga Disima de Loyo|Omar Icon|Larry Ca√±onga|Benito Camelo|Lola Mento|Alex Cremento|Ana Busado Dehesa|Ana Tom√≠a|Andres Tresado|Cindy Entes|Eddy Ficio|Elba Tracio|Elena Nito|Elmer Kado|Elmer cado|Elsa Nitario|Elsa Pato|Elton Tito|Elvio Lado|Elvio Lento|Elvis Cocho|Ema Amado Bustos|Alma Madero|Debora Testa|Rosa Melcacho|Alberto Catesta|Yotoko Turaja|Aquiles Castro|Sacarias Flores del Campo|Dolores Delano|Mela Halo|Casimiro Lateta|Ricopene|Rico Pene|Rosa Melaverga|Queso Badota|Quesobadota|Queso Vadota|Quesovadota",
            "variable_replace": {}
          },
          {
            "next": "datos-factura-resumen",
            "type": "regex",
            "value": "^([√°√©√≠√≥√∫√Å√â√ç√ì√ö√±√ëA-Za-z\\0-9\\s\\,\\.\\#\\-\\_\\+\\;\\:\\&\\*\\$]{1,15}.?\\,?\\s?\\b){1,5}\\.?$",
            "variable_replace": {
              "invoiceName": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "ask-nit-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Por favor, rep√≠teme tu *NIT* para la factura. üî¢\n\n_Recuerda escribirlo en *un s√≥lo mensaje* a continuaci√≥n._\n\n_(Ejemplo: 1911001 √≥ 15246K sin gui√≥n)_"
            }
          }
        ],
        "transitions": [
          {
            "next": "validate-nit",
            "type": "regex",
            "value": "([u00C0-√ø0-9\\s\\-\\k\\K\\]|[/[0-9]{4,10})",
            "variable_replace": {
              "invoiceNit": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "datos-factura-resumen",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "S√≠ ‚úÖ"
                },
                {
                  "id": "string",
                  "title": "No üö´"
                }
              ],
              "bodyText": "¬øLos datos que ingresaste son correctos?\n\nNIT: *{{invoiceNit}}*\nNombre: *{{invoiceName}}*\n\nSelecciona *s√≠* para confirmarlos o selecciona *no* para cambiarlos.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "save-invoice-info",
            "type": "contains",
            "value": "si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|va",
            "variable_replace": {}
          },
          {
            "next": "ask-nit",
            "type": "contains",
            "value": "no|nel|no|nely|nelly|√±o|norton",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "ask-nombre-factura-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Para crear tu factura, por favor ingresa nuevamente tu *nombre* o el de *tu empresa*. \n\nEscr√≠belo en un *solo mensaje*.\n\n_Aqu√≠ tienes un ejemplo: Empresa X_"
            }
          }
        ],
        "transitions": [
          {
            "next": "ask-nombre-factura-fallback",
            "type": "contains",
            "value": "cerote|puta|idiota|est√∫pido|estupido|hijo de puta|indio|negro|chino|covid|coronavi|covid-19|coronavirus|navirus|donald trump|AMLO|Pe√±a Nieto|peje|Queso Plas|Rosa Melano|Susana Horia|Benito Camela|Elba Ginon|Elvis Tek|Aquiles Bailo|Susana Distancia|Mama Dora|Zacarias Leche|Carmelo Machuca|Miguel Ambes Parada|Meardel Peson|Lalo Onganiza|Carmelo Tallas|Zacarias Blanco|Aquiles Pico|Marisa Caleche|Carmela Rosas|Willy Melano|Zacarias Bello Delano|Zoyla Alegria Delano|Ana Lisa Melchotto|Memo Herdez|Virginia Del Hoyo Aguado|Zoyla cerda|Deborah Vergara|Lucio Elano|Mar√≠a Melo Machuca|Paca Gartela|Pachin Gartela|Maite Lometo|Rosa Melgorro|Esther Colero|Paco Gerlo|Elver Galarga|Dora Melcacho|Zoyla Vaca|Alberto Catetas|Paco Mermela|Alberto Caco√±os|Alberto Caculos|Alberto Capollas|Alberto Capitos|Deborah Melculo|Abraham Melculo|Elsa Pito|Paco Mermela|Cindy Nero|Alma Marcela Goza de Alegria|Jony Melavo|Elba Gina|Paco Jerte|Rosamel Delgado|Edgar Ganta|Lola Meraz|Olga Disima de Loyo|Omar Icon|Larry Ca√±onga|Benito Camelo|Lola Mento|Alex Cremento|Ana Busado Dehesa|Ana Tom√≠a|Andres Tresado|Cindy Entes|Eddy Ficio|Elba Tracio|Elena Nito|Elmer Kado|Elmer cado|Elsa Nitario|Elsa Pato|Elton Tito|Elvio Lado|Elvio Lento|Elvis Cocho|Ema Amado Bustos|Alma Madero|Debora Testa|Rosa Melcacho|Alberto Catesta|Yotoko Turaja|Aquiles Castro|Sacarias Flores del Campo|Dolores Delano|Mela Halo|Casimiro Lateta|Ricopene|Rico Pene|Rosa Melaverga|Queso Badota|Quesobadota|Queso Vadota|Quesovadota",
            "variable_replace": {}
          },
          {
            "next": "datos-factura-resumen",
            "type": "regex",
            "value": "^([√°√©√≠√≥√∫√Å√â√ç√ì√ö√±√ëA-Za-z\\0-9\\s\\,\\.\\#\\-\\_\\+\\;\\:\\&\\*\\$]{1,15}.?\\,?\\s?\\b){1,5}\\.?$",
            "variable_replace": {
              "invoiceName": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "datos-factura-resumen-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Escribe *s√≠* para confirmar tus datos o escribe *no* si deseas cambiarlos. üòä\n\n*NIT:* *{{invoiceNit}}*\n*Nombre: {{invoiceName}}*"
            }
          }
        ],
        "transitions": [
          {
            "next": "payment-method",
            "type": "contains",
            "value": "si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|va",
            "variable_replace": {}
          },
          {
            "next": "ask-nit",
            "type": "contains",
            "value": "no|nel|no|nely|nelly|√±o|norton",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "cash-type",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "S√≠, continuar"
                },
                {
                  "id": "string",
                  "title": "Regresar"
                }
              ],
              "bodyText": "¬°Anotado! Tu m√©todo de pago es en *Efectivo.* üíµ\n\n¬øContinuamos?",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "efectivo-change",
            "type": "contains",
            "value": "continuar|si|shi|sipi|zipi|si|si|sicontinuar|si continuar|ok|si continuar",
            "variable_replace": {}
          },
          {
            "next": "payment-method",
            "type": "contains",
            "value": "regresar|inisio|atras|comenzar|tarjeta|en linea|pago en linea|link|link de pago|no|nel|nopo",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "payment-method-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Escribe el *n√∫mero* de la opci√≥n con la que deseas realizar tu pago üëáüèª:\n\n1Ô∏è‚É£ Tarjeta de cr√©dito o d√©bito üí≥\n2Ô∏è‚É£ Efectivo üíµ"
            }
          }
        ],
        "transitions": [
          {
            "next": "bh-migo",
            "type": "contains",
            "value": "uno|1|1Ô∏è‚É£|one|credito|tarjeta|cr√©dito|tarjeta de cr√©dito|targeta|targetas|debito|d√©bito|link|links",
            "variable_replace": {
              "userPaymentMethod": "Tarjeta"
            }
          },
          {
            "next": "cash-type",
            "type": "contains",
            "value": "dos|2|2Ô∏è‚É£|two|dois|doz|efectivo|cash|efektivo|Pago en restaurante|restaurante|cupon|vales|kupon|cup√≥n|vale",
            "variable_replace": {
              "userPaymentMethod": "Efectivo"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "webview-return",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "type": "script",
            "params": {
              "params": {
                "code": "-- Get the webhook's payload\nlocal webhookData = Context.get(\"webhookPayload\", \"json\")\n\n-- Parse the response\n--Debug.print(\"debug print: delivered!\")\n-- Debug.print(webhookData)\nContext.set(\"orderDetail\", webhookData)"
              },
              "script": "custom_script"
            }
          },
          {
            "next": "parse-order",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "parse-order",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "type": "script",
            "params": {
              "params": {
                "code": "function parseOrder ()\n    local base = Context.get('genericYalu')\n    local slug = Context.get('slug')\n    local userId = Context.get('userId')\n    \n    url = base .. \"/\" .. slug .. '/parseOrder/' .. userId\n    \n    local orderDetail = {}\n    local orderDetailData = Context.get('orderDetail')\n    if orderDetailData ~= nil then\n        orderDetail = JSON.decode(orderDetailData)    \n    end\n    \n    local order = {} \n    local orderData = Context.get('order')\n    if orderData ~= nil then\n        order = JSON.decode(orderData) \n    end\n     \n    body = {\n        order = order,\n        payload = orderDetail\n    }\n    \n    result = HTTP.post(url, body)\n    data = result.data\n    \n    Context.set(\"order\", data.data)\n    Workflow.branch(5) -- webview-resume\nend\n\nlocal status, err = pcall(parseOrder)\n\nif (err) then\n   --Debug.print(err)\n   Workflow.branch(23) -- error-parsing-order\nend"
              },
              "script": "custom_script"
            }
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "error-parsing-order",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Hubo un error al obtener tu orden. üòß\n\nIntenta seleccionar tus productos favoritos de nuevo. üôåüèª"
            }
          }
        ],
        "transitions": [
          {
            "next": "get-webview-parameters",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "enviar-orden",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "script-send-order",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "script-send-order",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "updateStatusOrder",
            "type": "script",
            "params": {
              "params": {
                "body": {},
                "method": "POST",
                "headers": {},
                "endpoint": "https://ye86lyi5w5.execute-api.us-east-1.amazonaws.com/prod/sendOrderSync"
              },
              "script": "yumpii-bot-middleware-prod-executeEndpoint"
            },
            "variable_replace": {
              "inyectar": "false"
            }
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "order-success",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°Listo! Tu pedido fue enviado con √©xito. üíô\n\nAqu√≠ est√°n los detalles de tu orden. üëáüèª\n\n*Tel√©fono:* {{userId}}\n*Nombre:* {{customer.fullName}}\n*N√∫mero de orden:* {{orderResult.data.data.orderId}}.\n\nEsta es la informaci√≥n de tu pedido: ‚¨áÔ∏è\n\n{{#each order.items}}\n{{this.quantity}} x {{this.product.name}} (Q{{this.subTotal}}){{#each this.product.customizations}}\n- {{this.title}}: {{#each this.options}}{{#if this.quantity}}{{this.title}}{{/if}}{{/each}}\n{{/each}}\n{{/each}}\n\nTotal: Q{{order.totalFormatted}}\nPago: {{userPaymentMethod}}\n{{#if orderComments}}\nComentario: {{orderComments}}\n{{/if}}"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Men√∫"
                }
              ],
              "bodyText": "Si deseas que te ayude en algo m√°s, selecciona *Men√∫*.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "men√∫|inicio|regresar",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "order-with-agent",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°Gracias por tu compra!  En breve te estar√© enviando el n√∫mero üî¢ de tu pedido. (Por favor no respondas este mensaje) üòä"
            }
          }
        ],
        "transitions": [
          {
            "next": "business-hours",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "validate-nit",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "ask-nombre-factura",
            "type": "script",
            "params": {
              "params": {
                "body": {},
                "method": "POST",
                "headers": {},
                "endpoint": "https://ye86lyi5w5.execute-api.us-east-1.amazonaws.com/prod/validateNit"
              },
              "script": "yumpii-bot-middleware-prod-executeEndpoint"
            },
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "old-nit-confirm",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬øDeseas utilizar los mismos datos de facturaci√≥n?\n\n*NIT:* {{invoiceNit}}\n*Nombre:* {{invoiceName}}"
            }
          }
        ],
        "transitions": [],
        "transition_delay": -1
      },
      {
        "key": "save-invoice-info",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "payment-method",
            "type": "script",
            "params": {
              "params": {
                "body": {},
                "method": "POST",
                "headers": {},
                "endpoint": "https://ye86lyi5w5.execute-api.us-east-1.amazonaws.com/prod/updateCustomer"
              },
              "script": "yumpii-bot-middleware-prod-executeEndpoint"
            },
            "variable_replace": {}
          }
        ],
        "transition_delay": 5
      },
      {
        "key": "change-payment",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Efectivo"
                }
              ],
              "bodyText": "Si tienes problemas con el enlace para realizar tu pago en l√≠nea, puedes cambiar tu m√©todo de pago a efectivo, seleccionando *efectivo.* üíµ",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "set-type-payment",
            "type": "contains",
            "value": "efectivo",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "set-type-payment",
        "content": [],
        "transitions": [],
        "transition_delay": 0
      },
      {
        "key": "choose-card",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°Anotado! üí≥"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Men√∫"
                }
              ],
              "bodyText": "En este momento mis compa√±eros est√°n procesando tu orden üßëüèª‚Äçüíªüë©üèΩ‚ÄçüíªEn breve te enviar√°n un enlace para que puedas realizar tu pago en l√≠nea con *tarjeta de cr√©dito o d√©bito.* ",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|inicio|regresar",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "send-order-error",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "updateStatusOrder-Ag",
            "variable_replace": {}
          }
        ],
        "transition_delay": 2
      },
      {
        "key": "summary-order",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Este es el resumen de tu pedido:\n*Pedido:* {{#each detail}}\n{{index}})  *_{{quantity}}x {{name}}_*  {{#ifEquals priceUnic 0}} {{else}}- Q{{priceUnic}}{{/ifEquals}}{{#if extras.length}}{{#each extras}}\n     - {{quantity}}*_x {{title}}_*{{#if priceUnic}} - Q{{priceUnic}}{{/if}}{{/each}}{{/if}}\n{{/each}}\n\n*Total:* Q{{total}}"
            }
          }
        ],
        "transitions": [],
        "transition_delay": -1
      },
      {
        "key": "webview-link-fallback-copy",
        "content": [
          {
            "type": "url_button",
            "value": {
              "url": "{{context.webviewURL}}",
              "label": "Ver platillos",
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "bodyText": "Recuerda que para iniciar tu pedido debes ingresar a nuestro men√∫ haciendo click en *Ver platillos*.\n\nUna vez eliges tus platillos favoritos y la cantidad de cada uno, selecciona el bot√≥n *\"Enviar pedido\"* y vuelve a WhatsApp para confirmarlo. üëáüèª",
              "footerText": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|inicio|inisio",
            "variable_replace": {}
          },
          {
            "next": "bye",
            "type": "contains",
            "value": "bye|bai|good bye|adi√≥s|bay|adios|ciao|chao|camara|c√°mara|hasta pronto|hasta lueg|hasta luego|nos vemos|bye!|bai!|adi√≥s!|bay!|adios!|ciao!|chao!|camara!|c√°mara!|hasta pronto!|hasta lueg!|hasta luego!|nos vemos!",
            "variable_replace": {}
          },
          {
            "next": "delivery-pickup",
            "type": "contains",
            "value": "regresar|regrezar|salir|empezar|comienzo|principio|pedir|ordenar|opciones",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "payment-method",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "error-save-invoice",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°Ocurri√≥ un problema al guardar tus datos! üòµ‚Äçüí´"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Intentar"
                },
                {
                  "id": "string",
                  "title": "Consumidor final"
                }
              ],
              "bodyText": "¬øDeseas intentar nuevamente con tu NIT?, selecciona la *opci√≥n*.\n\nSi quieres continuar sin factura, elige *Consumidor final*. üôåüèª",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "ask-nit",
            "type": "contains",
            "value": "nit|1|uno|intentar|otra vez|otra ves",
            "variable_replace": {}
          },
          {
            "next": "no-factura",
            "type": "contains",
            "value": "consumidor final |cf|dos|2",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "order-comments-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "No entend√≠ tu respuesta, *escribe tu comentario* en un solo mensaje (m√°ximo 60 caracteres).\n\n_Si no tienes comentarios, escribe *Continuar*._ üòä"
            }
          }
        ],
        "transitions": [
          {
            "next": "ask-factura",
            "type": "contains",
            "value": "continuar|conitnue",
            "variable_replace": {}
          },
          {
            "next": "order-comments-fallback",
            "type": "contains",
            "value": "cabron|chinga|chingan|chingas|chingon|chingada|chingadas|jode|jodes|jodidos|jodiendo|jodo|kulero|mamadas|mames|mams|mamon|mierda|mierda|mierdas|ni madres|pendeja|pendeja|pendejas|pendejo|pendejo|pendejos|pinche|pinches|ptm|puta|puta|putos|hdp|culero|putero|fuck|asshole|rateros|ratas|joto|joterias|joterias|caca|kaka|cagado|cagados|huevon|huevones|wevones|webones|webon|wevon|idiota|esperma|sperma|vagina|menstruaci√≥n|sexo|pucha|puchita|panocha|panochon|nepe|pito|pitos|pitero|putero|putas|puterias|puterias|puto|ratas|shinga|shingas|shingon|shing√≥n|shit|spm|verga|hdp|cagar|cagas|chinga|chingas|chingada|chingado|chingadoo|chingalos|chingao|chingaos|chingar|chingarlos|chingarnos|chingarte|chingate|chingatelos|chingo|chingon|chinguen|ching√≥n|chingalos|chingate|chingatelos|cancer|cancer|orgullo.com|condon|condones|cond√≥n|cojon|cojon|culera|culeras|culero|culeros|culo|huebo|huebos|huevo|joder|madrear|mamada|mamadas|mamar|mamarracho|mamen|mames|mamez|mamon|mamon|maricon|maric√≥n|mierda|mojon|ogete|ogetes|ojete|ojetes|pedorro|pendeja|pendejada|pendejadas|pendejas|pendejo|pinche|pinches|pinga|pito|pitos|puta|putas|putisima|putisimas|putisimo|putisimos|puto|putos|putisima|putisimas|putisimo|putisimos|pu√±al|pu√±ales|pu√±etas|pu√±eta|shingaa|webo|webos|wevo|wevos|putazo|pendejo|pendeja|pendejos|pendejotes|pendejas|chingado|cabron|chinga|culera|mamar|mamen|kabron|jodido|pinches|pito|ratas|marika|rreputa|reputisima|cerote|punal|joder|idiota|estupido|est√∫pido|mierda|putos|porno|nudes|desnudo|desnudos|pendejos|torpe|tonto|mamar|chingada|malditos|maldito|pendejos|tarado|masturbar|masturbando|masturbaci√≥n|masturbacion|masturbasion|marturbame|masturbame|masturvando|masturvar|masturbandome|masturvandome|chaqueta|chaqueteando|jalando|jalondomela|jalandomela|masturbandome|pajiando|pajas|paja|mestruar|menstruacion|menstruacion|menstruasion|menstruasion|tengo la regla|me vino|me vine|sexo|sexual|porno|coger|cojer|cogida|cojida|semen|pene|culo|culos|ano|nalga|nalgas|seno|senos|chiche|chiches|chichi|chichis|pechos|tetas|ubres|teta|caca|orinar|fisting|tonta|mensa|pendeja|wawis|clitoris|cl√≠toris|panocha|bizcocho|biscocho|perra|zorra|chupamela|chupamela|chupamela|gorda",
            "variable_replace": {}
          },
          {
            "next": "ask-factura",
            "type": "regex",
            "value": "^(?=.{1,60}$)[\\w\\s√°√©√≠√≥√∫√Å√â√ç√ì√ö√±√ë√º√ú.-\\p{P}]+$",
            "variable_replace": {
              "orderComments": "{{context.userMessage.content.text}}"
            }
          },
          {
            "next": "ask-factura",
            "type": "regex",
            "value": "^(?=.{1,60}$)[\\w\\s√°√©√≠√≥√∫√Å√â√ç√ì√ö√±√ë√º√ú.,\\.\\#\\-\\_\\+\\;\\:\\&\\*\\=\\p{P}]+$",
            "variable_replace": {
              "orderComments": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "cash-type-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬øDeseas seguir con Efectivo? Escribe la palabra *S√≠*.\n\nSi quieres cambiar de m√©todo, escribe la palabra *Regresar*."
            }
          }
        ],
        "transitions": [
          {
            "next": "enviar-orden",
            "type": "contains",
            "value": "continuar|si|shi|sipi|zipi|si|si|sicontinuar|si continuar|ok",
            "variable_replace": {}
          },
          {
            "next": "payment-method",
            "type": "contains",
            "value": "regresar|inisio|atras|comenzar|tarjeta|en linea|pago en linea|link|link de pago|no|nel|nopo",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "prueba fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Intenta de nuevo"
            }
          }
        ],
        "transitions": [],
        "transition_delay": -1
      },
      {
        "key": "webview-link ",
        "content": [
          {
            "type": "url_button",
            "value": {
              "url": "{{context.webviewURL}}",
              "label": "Men√∫ de platillos",
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "bodyText": "Al darle click a *Men√∫ de platillos*, podr√°s encontrar nuestros deliciosos platillos para disfrutar en donde quieras. üòã\n\nUna vez eliges tus platillos favoritos y la cantidad de cada uno, selecciona el bot√≥n *Enviar pedido* y vuelve a WhatsApp para confirmarlo.",
              "footerText": ""
            }
          },
          {
            "type": "text",
            "value": {
              "text": "> *_El m√≠nimo de compra es de Q70.00_*"
            }
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|inicio|inisio|salir",
            "variable_replace": {}
          },
          {
            "next": "business-hours",
            "type": "contains",
            "value": "asesor|ayuda|hablar con asesor",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "test",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "send-order-error",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "e-script-send-order",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "e-order-success",
            "type": "script",
            "params": {
              "params": {
                "body": {},
                "method": "POST",
                "headers": {},
                "endpoint": "https://lqiduilpni.execute-api.us-east-1.amazonaws.com/dev/sendOrderSync"
              },
              "script": "yumpii-bot-middleware-prod-executeEndpoint"
            },
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "e-order-success",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°Listo! Tu pedido fue enviado con √©xito. üíô\n\nAqu√≠ est√°n los detalles de tu orden. üëáüèª\n\n*Tel√©fono:* {{userId}}\n*Nombre:* {{userFullName}}\n*N√∫mero de orden:* *{{smOrder.orderRaw.id}}*.\n\nEsta es la informaci√≥n de tu pedido: ‚¨áÔ∏è\n\n{{#each order.items}}\n{{quantity}} x {{product.name}} (*Q*{{subTotal}}) {{#each product.customizations}}\n- {{title}}:  {{#each options}} {{quantity}} x {{title}} {{/each}} {{/each}} {{/each}}\n\n*Total: Q{{order.totalFormatted}}*\n{{#if orderComments}}\n*Comentario:* {{orderComments}} {{/if}}"
            }
          }
        ],
        "transitions": [
          {
            "next": "delivery-time",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "e-order-error",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Parece que hubo un error al enviar tu pedido al restaurante. Te comunicar√© con uno de mis compa√±eros para terminar tu pedido. üòä"
            }
          }
        ],
        "transitions": [],
        "transition_delay": -1
      },
      {
        "key": "delivery-time",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Estar√° llegando en un tiempo estimado de *40 a 50* minutos üòâ Toma en cuenta que los tiempos pueden variar acorde a la demanda. ¬°Buen provecho! ‚ú®ü•ñ"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Men√∫"
                }
              ],
              "bodyText": "Si deseas hacer algo m√°s, *selecciona Men√∫*",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|inicio|regresar",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "validate-store-before-send-order",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "params": {
              "code": "const orderJson = context.order;\nlet order = null;\n\nif (orderJson && typeof orderJson === \"string\") {\n  order = JSON.parse(orderJson);\n} else {\n  order = orderJson;\n}\n\nif (order && typeof order === \"object\") {\n  let branchId = null;\n  if (order.branch && typeof order.branch === \"object\") {\n    branchId = order.branch.id;\n  }\n\n  if (branchId === \"7c9762a8-8778-4a18-8729-1c5001daa3bd\") {\n    Context.set(\"nextStep\", 25);\n  } else {\n    Context.set(\"nextStep\", 235);\n  }\n}\n"
            }
          },
          {
            "type": "script",
            "params": {
              "params": {
                "code": "local orderJson = Context.get(\"order\")\r\nlocal order = nil\r\n\r\nif orderJson and type(orderJson) == \"string\" then\r\n  order = JSON.decode(orderJson)\r\nelse\r\n  order = orderJson\r\nend\r\n\r\nif not order or type(order) ~= \"table\" then\r\nelse\r\n  local branchId = nil\r\n  if order.branch and type(order.branch) == \"table\" then\r\n    branchId = order.branch.id\r\n  end\r\n\r\n  if branchId == \"7c9762a8-8778-4a18-8729-1c5001daa3bd\" then\r\n    Workflow.branch(25)\r\n  else\r\n    Workflow.branch(235)\r\n  end\r\nend"
              },
              "script": "custom_script"
            }
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "updateStatusOrder",
        "content": [],
        "transitions": [
          {
            "type": "script",
            "params": {
              "params": {
                "code": "function updateOrder ()\n    local base = Context.get('genericYalu')\n    local slug = Context.get('slug')\n    local userId = Context.get('userId')\n    \n    url = base .. \"/\" .. slug .. '/order'\n    --Debug.print('url', url)\n    \n    \n    local order = JSON.decode(Context.get('order'))\n     \n    body = {\n        id = order.id,\n        status = \"PROCESSED\"\n    }\n    \n    result = HTTP.put(url, body)\n\n    data = result.data\n    \n   -- Workflow.branch(26)\n      Workflow.branch(244)\nend\nlocal status, err = pcall(updateOrder)\n\nif (err) then\n   --Debug.print(err)\nend"
              },
              "script": "custom_script"
            }
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "order-with-agent-copy",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°Gracias por tu compra!!  En breve te estar√© enviando el n√∫mero üî¢ de tu pedido. (Por favor no respondas este mensaje) üòä"
            }
          }
        ],
        "transitions": [
          {
            "next": "business-hours",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "efectivo-change",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "S√≠"
                },
                {
                  "id": "string",
                  "title": "No"
                }
              ],
              "bodyText": "¬øNecesit√°s que el repartidor lleve cambio a tu domicilio? üíµ",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "how-much-change",
            "type": "contains",
            "value": "si|simon|yes|orale|sip|1",
            "variable_replace": {}
          },
          {
            "next": "enviar-orden",
            "type": "contains",
            "value": "no|nel|nelson|nop|2|norton",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "how-much-change",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Muy bien, escribe la *cantidad total* con la que pagar√°s para llevarte cambio.\n\n_Escr√≠belo solo con n√∫meros._ _*Ejemplo: 75.50*_"
            }
          }
        ],
        "transitions": [
          {
            "next": "enviar-orden",
            "type": "regex",
            "value": "^([0-9]{1,3})($|\\.[0-9]{1,2})",
            "variable_replace": {
              "change": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "efectivo-change-fallback",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "S√≠"
                },
                {
                  "id": "string",
                  "title": "No"
                }
              ],
              "bodyText": "Para confirmar que deseas cambio de efectivo selecciona *s√≠*, de lo contrario selecciona *no*.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "how-much-change",
            "type": "contains",
            "value": "si|simon|yes|orale|sip|1",
            "variable_replace": {}
          },
          {
            "next": "enviar-orden",
            "type": "contains",
            "value": "no|nel|nelson|nop|2|norton",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "how-much-change-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Solo *escribe la* *cantidad en n√∫meros* del monto total que pagar√°s, de esta manera el repartidor te llevar√° el cambio exacto de tu pago. üî¢\n\n*Ejemplo: 85*"
            }
          }
        ],
        "transitions": [
          {
            "next": "enviar-orden",
            "type": "regex",
            "value": "^([0-9]{1,3})($|\\.[0-9]{1,2})",
            "variable_replace": {
              "change": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "updateStatusOrder-Ag",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "type": "script",
            "params": {
              "params": {
                "code": "function updateOrder ()\n    local base = Context.get('genericYalu')\n    local slug = Context.get('slug')\n    local userId = Context.get('userId')\n    \n    url = base .. \"/\" .. slug .. '/order'\n    Debug.print('url', url)\n    \n    \n    local orderData = Context.get('order')\n    local order = JSON.decode(orderData)\n     \n    body = {\n        id = order.id,\n        status = \"PROCESSED\"\n    }\n    \n    result = HTTP.put(url, body)\n\n    data = result.data\n    \n    Workflow.branch(27)\nend\nlocal status, err = pcall(updateOrder)\n\nif (err) then\n   Debug.print(err)\nend"
              },
              "script": "custom_script"
            }
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "uptdateStatusOrder-Ag2",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "type": "script",
            "params": {
              "params": {
                "code": "function updateOrder ()\n    local base = Context.get('genericYalu')\n    local slug = Context.get('slug')\n    local userId = Context.get('userId')\n    \n    url = base .. \"/\" .. slug .. '/order'\n    Debug.print('url', url)\n    \n    \n    local orderData = Context.get('order')\n    local order = JSON.decode(orderData)\n     \n    body = {\n        id = order.id,\n        status = \"PROCESSED\"\n    }\n    \n    result = HTTP.put(url, body)\n\n    data = result.data\n    \n    Workflow.branch(228)\nend\nlocal status, err = pcall(updateOrder)\n\nif (err) then\n   Debug.print(err)\nend"
              },
              "script": "custom_script"
            }
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "ask-nit-copy",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "(nuevo)\n\nBien, ahora ind√≠came en un s√≥lo mensaje tu *NIT*. üî¢\n\n_Ejemplo: 231100-1_"
            }
          }
        ],
        "transitions": [
          {
            "next": "validate-nit",
            "type": "regex",
            "value": "([u00C0-√ø0-9\\s\\-\\k\\K\\]|[/[0-9]{4,10})",
            "variable_replace": {
              "invoiceNit": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "datos-factura-resumen-copy",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "S√≠ ‚úÖ"
                },
                {
                  "id": "string",
                  "title": "No üö´"
                }
              ],
              "bodyText": "¬øLos datos que ingresaste son correctos?\n\nNIT: *{{invoiceNit}}*\nNombre: *{{nitValidation.data.name}}*\n\nSelecciona *s√≠* para confirmarlos o selecciona *no* para cambiarlos.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "save-invoice-info",
            "type": "contains",
            "value": "si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|va",
            "variable_replace": {}
          },
          {
            "next": "ask-nit",
            "type": "contains",
            "value": "no|nel|no|nely|nelly|√±o|norton",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "conteo-intentos-nit",
        "content": [],
        "transitions": [
          {
            "params": {
              "code": "const limit = 2;\nlet countErrorNit = context.countErrorNit !== null && context.countErrorNit !== undefined\n  ? Number(context.countErrorNit)\n  : 0;\n\nif (countErrorNit === limit) {\n  Context.set(\"nextStep\", 239);\n} else {\n  countErrorNit += 1;\n  Context.set(\"countErrorNit\", countErrorNit);\n  Context.set(\"nextStep\", 15);\n}\n"
            }
          },
          {
            "type": "script",
            "params": {
              "params": {
                "code": "limit = 2\n\tif Context.get(\"countErrorNit\") ~= nil then\n\tcountErrorNit = tonumber(Context.get(\"countErrorNit\"))\n\telse\n\tcountErrorNit = 0\n\tend\n\tif countErrorNit == limit then\n\t\tWorkflow.branch(239)\n\telse\n\t\tcountErrorNit = countErrorNit + 1\n\t\tContext.set(\"countErrorNit\", countErrorNit)\n\t\tWorkflow.branch(15)\n\tend"
              },
              "script": "custom_script"
            }
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "limit-intentos-nit",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Continuar CF"
                },
                {
                  "id": "string",
                  "title": "Hablar con un Agente"
                }
              ],
              "bodyText": "No he logrado validar el NIT, pero podemos continuar la facturaci√≥n como Consumidor Final (CF).\n\n¬øDeseas continuar?",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "business-hours",
            "type": "contains",
            "value": "hablar con una gente|agente",
            "variable_replace": {
              "countErrorNit": ""
            }
          },
          {
            "next": "no-factura",
            "type": "contains",
            "value": "continuar cf|cf|consumidor final",
            "variable_replace": {
              "invoiceNit": "CF",
              "invoiceOption": "No"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "ask-factura-copy",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "S√≠"
                },
                {
                  "id": "string",
                  "title": "No"
                }
              ],
              "bodyText": "¬øDeseas datos para tu factura? üßæ\n\nSelecciona *s√≠* para ingresarlos o selecciona *no* para continuar con _Consumidor Final_.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "ask-nit",
            "type": "contains",
            "value": "si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|va",
            "variable_replace": {
              "invoiceOption": "S√≠"
            }
          },
          {
            "next": "no-factura-copy",
            "type": "contains",
            "value": "no|nel|no|nely|nelly|√±o|norton|consumidor final|cf|no (cf)",
            "variable_replace": {
              "invoiceNit": "CF",
              "invoiceOption": "No"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "no-factura-copy",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "De acuerdo, tu factura estar√° como *Consumidor Final.* üòä"
            }
          }
        ],
        "transitions": [
          {
            "next": "save-invoice-info",
            "variable_replace": {}
          }
        ],
        "transition_delay": 2
      },
      {
        "key": "jump-ux-test",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "order-success",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "migo-payment-success-copy",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°Tu pago ha sido realizado con √©xito! ‚úÖ.\nTus datos de referencia son los siguientes: üëáüèº\n\n*Referencia*:  {{payment.transaction.reference}}\n*Autorizaci√≥n:* {{payment.transaction.paymentData.pay.processorInformation.approvalCode}}"
            }
          }
        ],
        "transitions": [
          {
            "next": "order-success",
            "variable_replace": {}
          }
        ],
        "transition_delay": 1
      },
      {
        "key": "PDF Voucher-copy",
        "content": [
          {
            "type": "document",
            "value": {
              "url": "{{context.voucherUrl}}",
              "caption": "Comprobante de pago",
              "filename": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "migo-payment-success-copy",
            "variable_replace": {}
          }
        ],
        "transition_delay": 1
      },
      {
        "key": "business-hours",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "human-intro",
            "type": "script",
            "params": {
              "params": {
                "body": {},
                "method": "POST",
                "headers": {},
                "endpoint": "https://d9rsao4hm4.execute-api.us-east-1.amazonaws.com/staging/business"
              },
              "script": "yumpii-bot-middleware-prod-executeEndpoint"
            },
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "human-intro",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "En un momento uno de mis compa√±eros te atender√° üßëüèª‚Äçüíªüë©üèΩ‚Äçüíª"
            }
          }
        ],
        "transitions": [
          {
            "next": "humanLoop",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "human-closed",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "En este momento nuestros agentes  est√°n fuera del horario de atenci√≥n.\n\nTe recordamos que el horario de atenci√≥n es de *lunes a domingo de* *07:00am a 08:30pm.*"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Pregunta"
                },
                {
                  "id": "string",
                  "title": "Men√∫"
                }
              ],
              "bodyText": "Si tienes alguna consulta que quieras hacerme, no dudes en seleccionar *pregunta*. Si prefieres regresar, solo elige *Men√∫*. üôÇ",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "FAQ start",
            "type": "contains",
            "value": "pregunta|consulta|duda|consultar|tengo dudas",
            "variable_replace": {}
          },
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|regresar al menu|inicio|empezar|ver el menu|ver menu",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "humanLoop",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [],
        "transition_delay": -1
      },
      {
        "key": "byebyetransition",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "pivotbye",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "pivotbye",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "welcome-again",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "byebyewaiting",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "waiting_cust_resp",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "waiting_cust_resp",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "after_cust_response",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "after_cust_response",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "business-hours",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "h-closed-alta-demanda",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Men√∫"
                }
              ],
              "bodyText": "*Lamentamos no poder atenderte en este momento, nuestro canal se encuentra con alta demanda, realiza tus pedidos llamando al 22151515, desde nuestro Call Center te atenderemos con gusto*",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|regresar al menu|inicio|empezar|ver el menu|ver menu",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "business-hours-Reportar_un_problema",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "human-intro-Reportar_un_problema",
            "type": "script",
            "params": {
              "params": {
                "body": {},
                "method": "POST",
                "headers": {},
                "endpoint": "https://d9rsao4hm4.execute-api.us-east-1.amazonaws.com/staging/business"
              },
              "script": "yumpii-bot-middleware-prod-executeEndpoint"
            },
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "human-intro-Reportar_un_problema",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "En unos instantes, alguien de nuestro equipo continuar√° contigo. üßëüèª‚Äçüíªüë©üèΩ‚Äçüíª"
            }
          }
        ],
        "transitions": [
          {
            "next": "humanLoop",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "business-hours-Solicitar_asistencia",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "human-intro-Solicitar_asistencia",
            "type": "script",
            "params": {
              "params": {
                "body": {},
                "method": "POST",
                "headers": {},
                "endpoint": "https://d9rsao4hm4.execute-api.us-east-1.amazonaws.com/staging/business"
              },
              "script": "yumpii-bot-middleware-prod-executeEndpoint"
            },
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "human-intro-Solicitar_asistencia",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Un miembro de nuestro equipo te asistir√° en unos momentos. üßëüèª‚Äçüíªüë©üèΩ‚Äçüíª"
            }
          }
        ],
        "transitions": [
          {
            "next": "humanLoop",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "Default",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Disculpa, no comprend√≠ tu mensaje ü§î."
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Men√∫ ü•ñ "
                }
              ],
              "bodyText": "Si necesitas ver otras opciones que tengo para ti, selecciona *Men√∫*.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "hiAgain",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "{{#random 3}}\n{{#opt}}¬°Hola, *{{userName.text}}*! Me alegra tenerte por aqu√≠ nuevamente. üòäü•ñ Te saluda *Ana*üôãüèª‚Äç‚ôÄÔ∏è, tu asistente virtual.\n{{/opt}}\n{{#opt}} ¬°Qu√© gusto verte de nuevo, *{{userName.text}}*!ü•ñ Te saluda *Ana*üôãüèª‚Äç‚ôÄÔ∏è, tu asistente virtual.\n{{/opt}}\n{{#opt}}¬°Te doy nuevamente una bienvenida, *{{userName.text}}*! Te saluda *Ana*üôãüèª‚Äç‚ôÄÔ∏è, tu asistente virtual.\n{{/opt}}\n{{/random}}"
            }
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "variable_replace": {}
          }
        ],
        "transition_delay": 1
      },
      {
        "key": "bye",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "{{#random 3}}\n{{#opt}}¬°Hasta pronto! üëãüèª\n{{/opt}}\n{{#opt}}¬°Nos vemos!\n{{/opt}}\n{{#opt}}¬°Vuelve pronto!\n{{/opt}}\n{{/random}}"
            }
          }
        ],
        "transitions": [],
        "transition_delay": -1
      },
      {
        "key": "maintenance",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "ü§ñ ¬°Lo siento! Me est√°n dando mantenimiento.\nPronto estar√© lista para atenderte, por favor, intenta m√°s tarde."
            }
          }
        ],
        "transitions": [],
        "transition_delay": -1
      },
      {
        "key": "identity",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Mi nombre es *Ana* üôãüèª‚Äç‚ôÄÔ∏è soy asistente virtual de *San Mart√≠n*. ü•ñ Puedo ayudarte a hacer un pedido o resolver cualquier duda que surja de nuestros servicios. üòä"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Men√∫ ü•ñ "
                }
              ],
              "bodyText": "Selecciona *Men√∫* e iniciemos. ",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "laugh",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "{{#random 3}}\n{{#opt}}Jejejeje ü§≠\n{{/opt}}\n{{#opt}}Jajajaja\n{{/opt}}\n{{#opt}}üòÜüòú\n{{/opt}}\n{{/random}}"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Pedido"
                }
              ],
              "bodyText": "Si deseas iniciar tu pedido selecciona *pedido* e iniciemos. ",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "delivery-pickup",
            "type": "contains",
            "value": "pedido",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "giveLove",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "{{#random 3}}\n{{#opt}}¬°Muchas gracias! ‚ò∫Ô∏è\n{{/opt}}\n{{#opt}}ü§ó \n{{/opt}}\n{{#opt}}ü•∞\n{{/opt}}\n{{/random}}"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Men√∫ ü•ñ "
                }
              ],
              "bodyText": "Si deseas volver al inicio, selecciona *men√∫*. üòä",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|men√∫",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "brandLove",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Me encargar√© de que la gente importante se entere de esto. ü•∞"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Men√∫ ü•ñ "
                }
              ],
              "bodyText": "Si necesitas ayuda con algo m√°s, selecciona *men√∫*.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "yourWelcome",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "{{#random 3}}\n{{#opt}}Siempre es un placer atenderle üòå\n{{/opt}}\n{{#opt}}¬°De nada! ü§ó\n{{/opt}}\n{{#opt}}Fue un placer üòâ\n{{/opt}}\n{{/random}}"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Pedido"
                }
              ],
              "bodyText": "Si deseas iniciar tu pedido selecciona *pedido* e iniciemos. ü§©",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "delivery-pickup",
            "type": "contains",
            "value": "pedido",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "ok",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "{{#random 3}}\n{{#opt}}üòä\n{{/opt}}\n{{#opt}}üëåüèº\n{{/opt}}\n{{#opt}}üòâ\n{{/opt}}\n{{/random}}"
            }
          }
        ],
        "transitions": [],
        "transition_delay": -1
      },
      {
        "key": "insult",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "{{#random 3}}\n{{#opt}}ü§≠\n{{/opt}}\n{{#opt}}Respeto ante todo üôè \n{{/opt}}\n{{#opt}}üòß\n{{/opt}}\n{{/random}}"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Ayuda"
                }
              ],
              "bodyText": "Si tienes una duda de nuestros servicios selecciona *ayuda* y uno de mis compa√±eros te atender√°.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "business-hours",
            "type": "contains",
            "value": "ayuda|agente|asesor|persona|alguien real|atenci√≥n al cliente|alguien|humano|no robot|atencion|ayuda humana|ayuda",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "audio_input",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Hablemos por mensaje, a√∫n no puedo escuchar audios."
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Ayuda"
                }
              ],
              "bodyText": "Si tienes una duda de nuestros servicios selecciona *ayuda* y uno de mis compa√±eros te atender√°.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "business-hours",
            "type": "contains",
            "value": "ayuda|agente|asesor|persona|alguien real|atenci√≥n al cliente|alguien|humano|no robot|atencion|ayuda humana|ayuda",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "file_input",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Una disculpa, a√∫n no puedo leer documentos. Mejor hablemos por mensaje."
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Ayuda"
                }
              ],
              "bodyText": "Si tienes una duda de nuestros servicios selecciona *ayuda* y uno de mis compa√±eros te atender√°.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "business-hours",
            "type": "contains",
            "value": "ayuda|agente|asesor|persona|alguien real|atenci√≥n al cliente|alguien|humano|no robot|atencion|ayuda humana|ayuda",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "image_input",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Por el momento no puedo ver im√°genes. ¬øQu√© te parece si hablamos por mensaje?"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Ayuda"
                }
              ],
              "bodyText": "Si tienes una duda de nuestros servicios selecciona *ayuda* y uno de mis compa√±eros te atender√°.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "business-hours",
            "type": "contains",
            "value": "ayuda|agente|asesor|persona|alguien real|atenci√≥n al cliente|alguien|humano|no robot|atencion|ayuda humana|ayuda",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "video_input",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Lo lamento, a√∫n no puedo ver videos. Mejor hablemos por mensaje."
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Ayuda"
                }
              ],
              "bodyText": "Si tienes una duda de nuestros servicios selecciona *ayuda* y uno de mis compa√±eros te atender√°.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "business-hours",
            "type": "contains",
            "value": "ayuda|agente|asesor|persona|alguien real|atenci√≥n al cliente|alguien|humano|no robot|atencion|ayuda humana|ayuda",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "voicenote_input",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Hablemos por mensaje, a√∫n no puedo escuchar mensajes de voz."
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Ayuda"
                }
              ],
              "bodyText": "Si tienes una duda de nuestros servicios selecciona *ayuda* y uno de mis compa√±eros te atender√°.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "business-hours",
            "type": "contains",
            "value": "ayuda|agente|asesor|persona|alguien real|atenci√≥n al cliente|alguien|humano|no robot|atencion|ayuda humana|ayuda",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "scope-global-component",
        "content": [],
        "transitions": [
          {
            "next": "init",
            "type": "contains",
            "value": "restart|reiniciar",
            "variable_replace": {}
          },
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|men√∫|memu|mem√∫",
            "variable_replace": {}
          },
          {
            "next": "delivery-pickup",
            "type": "contains",
            "value": "pedir|pedido",
            "variable_replace": {}
          },
          {
            "next": "business-hours",
            "type": "contains",
            "value": "ayuda|aiuda|humano|asesor|agente|agentes|humanos|help|english|operador|representante|staff|persona|empleado|funcionario|tecnico|t√©cnico|quejar|quejas|urge|urgente|problema",
            "variable_replace": {}
          },
          {
            "next": "FAQ start",
            "type": "contains",
            "value": "dudas|tengo dudas|preguntas|tengo preguntas",
            "variable_replace": {}
          },
          {
            "next": "bye",
            "type": "contains",
            "value": "bye|bai|good bye|adi√≥s|bay|adios|ciao|chao|camara|c√°mara|hasta pronto|hasta lueg|hasta luego|nos vemos|bye!|bai!|adi√≥s!|bay!|adios!|ciao!|chao!|camara!|c√°mara!|hasta pronto!|hasta lueg!|hasta luego!|nos vemos!",
            "variable_replace": {}
          },
          {
            "next": "hiAgain",
            "type": "contains",
            "value": "hola|ola|oli|holi|holo|hi|hey|hello|que onda|ondiux|quiubole|que hubo|hubo|uvas|honduras|onduras|bonjour|buenas tardes|buenos d√≠as|buenas noches|buen dia|buena tarde|buena noche|buenas",
            "variable_replace": {}
          },
          {
            "next": "identity",
            "type": "contains",
            "value": "eres|robot|robot|bot|quien eres|persona|humano",
            "variable_replace": {}
          },
          {
            "next": "yourWelcome",
            "type": "contains",
            "value": "gracias|super|orale|√≥rale|grasias|grazias|graxs|grax|s√∫per|thanks|thank|thank",
            "variable_replace": {}
          },
          {
            "next": "insult",
            "type": "contains",
            "value": "cabron|cabr√≥n|chinga|chingan|chingas|chingon|chingada|chingadas|jode|jodes|jodidos|jodiendo|jodo|kulero|mamadas|mames|mams|mam√≥n|mierda|mierda|mierdas|ni madres|pendeja|pendeja|pendejas|pendejo|pendejo|pendejos|pinche|pinches|ptm|puta|puta|putos|hdp|culero|putero|fuck|asshole|rateros|ratas|joto|joterias|joter√≠as|caca|kaka|cagado|cagados|huevon|huevones|wevones|webones|webon|wevon|idiota|esperma|sperma|vagina|menstruaci√≥n|sexo|pucha|puchita|panocha|panochon|nepe|pito|pitos|pitero|putero|putas|puterias|puter√≠as|puto|ratas|shinga|shingas|shingon|shing√≥n|shit|spm|verga|hdp|cagar|cagas|chinga|chingas|chingada|chingado|chingadoo|chingalos|chingao|chingaos|chingar|chingarlos|chingarnos|chingarte|chingate|chingatelos|chingo|chingon|chinguen|ching√≥n|ch√≠ngalos|ch√≠ngate|ch√≠ngatelos|c√°ncer|cancer|orgullo.com|condon|condones|cond√≥n|cojon|coj√≥n|culera|culeras|culero|culeros|culo|huebo|huebos|huevo|huevos|joder|madrear|mamada|mamadas|mamar|mamarracho|mamen|mames|mamez|mamon|mam√≥n|maricon|maric√≥n|mierda|mojon|moj√≥n|ogete|ogetes|ojete|ojetes|pedorro|pendeja|pendejada|pendejadas|pendejas|pendejo|pinche|pinches|pinga|pito|pitos|puta|putas|putisima|putisimas|putisimo|putisimos|puto|putos|put√≠sima|put√≠simas|put√≠simo|put√≠simos|pu√±al|pu√±ales|pu√±etas|pu√±eta|shingaa|webo|webos|wevo|wevos|putazo|pendejo|pendeja|pendejos|pendejotes|pendejas|chingado|cabron|chinga|culera|mamar|mamen|kabron|jodido|pinches|pito|ratas|marika|rreputa|reputisima|cerote|punal|joder|idiota|estupido|est√∫pido|mierda|putos|porno|nudes|desnudo|desnudos|pendejos|torpe|tonto|mamar|chingada|malditos|maldito|pendejos|tarado|masturbar|masturbando|masturbaci√≥n|masturbacion|masturbasion|marturbame|mast√∫rbame|masturvando|masturvar|masturb√°ndome|masturvandome|chaqueta|chaqueteando|jalando|jal√°ndomela|jalandomela|masturbandome|pajiando|pajas|paja|mestruar|menstruacion|menstruaci√≥n|menstruasion|menstruasi√≥n|tengo la regla|me vino|me vine|sexo|sexual|porno|coger|cojer|cogida|cojida|semen|pene|nalga|nalgas|seno|senos|chiche|chiches|chichi|chichis|pechos|tetas|teta|caca|orinar|fisting|wawis|clitoris|cl√≠toris|bizcocho|biscocho|perra|zorra|chupamela|chup√°mela|ch√∫pamela|chupada|chupadas|pornhub|porn hub|xvideos|x videos|you jizz|youjizz|you porn|youporn|yuporn|yuyizz|equis videos|equisvideos|pinshi|reputo",
            "variable_replace": {}
          },
          {
            "next": "giveLove",
            "type": "contains",
            "value": "te amo|te quiero|me gustas|te adoro|eres el mejor|eres la mejor|eres lo mejor|amor|quieres ser mi novio|quieres ser mi novia|andar conmigo",
            "variable_replace": {}
          },
          {
            "next": "ok",
            "type": "contains",
            "value": "buena|bien|cool|kool|chilera|excelente|f√°cil|me gust√≥|acertada|exelente|ecxelente|perfecta|atinada|efectiva|usable|facil|asertada|good",
            "variable_replace": {}
          },
          {
            "next": "laugh",
            "type": "contains",
            "value": "jaja|jaj|jajaja|jajajaja|jajaja|jaaaa|jajajaja|kakaka|kakakaka|jaaa|jajjaja|jaajaja|ajaja|ajajaja|ajajajajaja|jajajajaja|wajaja|wajajaja|wajajajaja|ajajaj|jajaj|que risa|qu√© risa|me diviertes|divertido|chistoso",
            "variable_replace": {}
          },
          {
            "next": "image_input",
            "type": "format",
            "value": "image",
            "variable_replace": {}
          },
          {
            "next": "video_input",
            "type": "format",
            "value": "video",
            "variable_replace": {}
          },
          {
            "next": "file_input",
            "type": "format",
            "value": "document",
            "variable_replace": {}
          },
          {
            "next": "audio_input",
            "type": "format",
            "value": "audio",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "Main Starter",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "Csat",
            "type": "contains",
            "value": "prueba-csat-ux",
            "variable_replace": {}
          },
          {
            "next": "init",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "welcome",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "{{#random 3}}\n{{#opt}}¬°Hola! Mi nombre es *Ana* üôãüèª‚Äç‚ôÄÔ∏è Soy asistente virtual de *San Mart√≠n*, estoy para ayudarte y guiarte en lo que necesites. üòäü•ñ\n{{/opt}}\n{{#opt}} Te doy la bienvenida al nuevo canal de WhatsApp de *San Mart√≠n*.ü•ñ Mi nombre es *Ana*, estoy para apoyarte en lo que necesites. üôãüèª‚Äç‚ôÄÔ∏è\n{{/opt}}\n{{#opt}}¬°Hola! Mi nombre es *Ana* üôãüèª‚Äç‚ôÄÔ∏è, asistente virtual de *San Mart√≠n*. Te estar√© guiando y ayudando cuando lo necesites. üòäü•ñ\n{{/opt}}\n{{/random}}"
            }
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "auto",
            "dela": 0,
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "menu",
        "content": [
          {
            "type": "image",
            "value": {
              "url": "https://images-support.s3.us-east-1.amazonaws.com/San+Martin/CV_38629.jpg",
              "caption": ""
            },
            "caption": ""
          },
          {
            "type": "button",
            "value": {
              "footerText": "",
              "buttons": [
                {
                  "id": "domicilio",
                  "title": "üõµ Domicilio"
                },
                {
                  "id": "pregunta",
                  "title": "‚ùì Pregunta"
                },
                {
                  "id": "asesor",
                  "title": "üôãüèª‚Äç‚ôÇÔ∏è Asesor"
                }
              ]
            },
            "caption": "Te puedo ayudar con las siguientes opciones üëáüèª\n\n¬°Ser√° un gusto atenderte! üòä"
          }
        ],
        "transitions": [
          {
            "position": 0,
            "type": "regex",
            "value": "^(üõµ Domicilio|1|uno|one|1Ô∏è‚É£|domicilio|domisilio|en casa|casa|apartamento|edificio|oficina|ofisina|office|a mi casa|üõµ)$",
            "variable_replace": {
              "tipoPedido": "Delivery"
            },
            "next": "bh-before-pedido"
          },
          {
            "position": 1,
            "type": "regex",
            "value": "^(dudas|preguna|pregunta|tengo dudas|preguntas|tengo preguntas|‚ùì|2|dos|two|2Ô∏è‚É£|segundo)$",
            "variable_replace": {},
            "next": "FAQ start"
          },
          {
            "position": 2,
            "type": "regex",
            "value": "^(asesor|ayuda|consultar|consulta|3|tres|three|contacto asesor|asesor|3Ô∏è‚É£|üôç‚Äç‚ôÇÔ∏è contacto asesor|üôãüèª‚Äç‚ôÇÔ∏è)$",
            "variable_replace": {},
            "next": "business-hours"
          },
          {
            "position": 3,
            "type": "regex",
            "value": "^(pedido|pedir)$",
            "variable_replace": {},
            "next": "greeting"
          },
          {
            "position": 4,
            "type": "regex",
            "value": "^(factura)$",
            "variable_replace": {},
            "next": "ask-factura"
          },
          {
            "position": 5,
            "type": "regex",
            "value": "^(nombre)$",
            "variable_replace": {},
            "next": "user-name"
          },
          {
            "position": 6,
            "type": "regex",
            "value": "^(cash-test)$",
            "variable_replace": {},
            "next": "cash-type"
          },
          {
            "position": 7,
            "type": "regex",
            "value": "^(test-genie)$",
            "variable_replace": {},
            "next": "Inicio KG"
          },
          {
            "position": 8,
            "type": "regex",
            "value": "^(prueba-csat-ux)$",
            "variable_replace": {},
            "next": "Csat"
          },
          {
            "position": 9,
            "type": "regex",
            "value": "^(registro-flow)$",
            "variable_replace": {},
            "next": "registro-flow"
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "bh-before-pedido",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "<<BH BEFORE PEDIDO>>"
            }
          }
        ],
        "transitions": [
          {
            "type": "auto",
            "position": 0,
            "business_hours": "delivery",
            "next": "greeting",
            "delay": 0,
            "params": {},
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "menu-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬øMe repites tu respuesta? Escribe el *n√∫mero* o la *palabra* de la opci√≥n con la que deseas continuar:\n\n1Ô∏è‚É£ Hacer un pedido *a domicilio* üõµ\n2Ô∏è‚É£ Hacer una *pregunta* ‚ùì\n3Ô∏è‚É£ Hablar con un *asesor* üôãüèª‚Äç‚ôÇÔ∏è"
            }
          }
        ],
        "transitions": [
          {
            "next": "bh-before-pedido",
            "type": "contains",
            "value": "1|uno|one|1Ô∏è‚É£|domicilio|domisilio|en casa|casa|apartamento|edificio|oficina|ofisina|office|a mi casa|üõµ",
            "variable_replace": {
              "tipoPedido": "Domicilio"
            }
          },
          {
            "next": "FAQ start",
            "type": "contains",
            "value": "dudas|preguna|pregunta|tengo dudas|preguntas|tengo preguntas|‚ùì|2|dos|two|segundo|2Ô∏è‚É£",
            "variable_replace": {}
          },
          {
            "next": "business-hours",
            "type": "contains",
            "value": "asesor|ayuda|consultar|3|tres|threee|3Ô∏è‚É£|tercera|three|3Ô∏è‚É£ hablar con un asesor üôãüèª‚Äç‚ôÇÔ∏è|asesor üôãüèª‚Äç‚ôÇÔ∏è|asesor|hablar con un asesor üôãüèª‚Äç‚ôÇÔ∏è",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "restaurant-closed",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Disculpa, por ahora nos encontramos fuera de horario de atenci√≥n. üåö Por favor, int√©ntalo de nuevo m√°s tarde y con gusto te atender√©. üòä"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Men√∫"
                }
              ],
              "bodyText": "Para ver otras opciones con las que te puedo ayudar selcciona *Men√∫*.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "loop-breaker",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "loop-breaker",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "welcome-again",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "{{#random 3}}\n{{#opt}}¬°Hola, *{{customer.fullName}}*! Me alegra tenerte por aqu√≠ nuevamente. üòäü•ñ Te saluda *Ana* üôãüèª‚Äç‚ôÄÔ∏è, tu asistente virtual.\n{{/opt}}\n{{#opt}} ¬°Qu√© gusto verte de nuevo, *{{customer.fullName}}*!ü•ñ Te saluda *Ana* üôãüèª‚Äç‚ôÄÔ∏è, tu asistente virtual.\n{{/opt}}\n{{#opt}}¬°Te doy nuevamente una bienvenida, *{{customer.fullName}}*! Te saluda *Ana* üôãüèª‚Äç‚ôÄÔ∏è, tu asistente virtual.\n{{/opt}}\n{{/random}}"
            }
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "variable_replace": {}
          }
        ],
        "transition_delay": 1
      },
      {
        "key": "script-validate-first-time",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "<<VALIDANDO CLIENTE>>"
            }
          }
        ],
        "transitions": [
          {
            "next": "",
            "type": "script",
            "delay": 0,
            "params": {
              "script": "yumpii-bot-middleware-prod-validateCustomer",
              "transitions": {
                "error": "welcome",
                "success-new": "welcome",
                "success-returning": "welcome-again"
              }
            },
            "position": 0
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "QA",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "get-location",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "remainder-mantenimiento",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Lamentamos no poder atenderte en este momento; nuestro canal se encuentra con alta demanda. Realiza tus pedidos llamando al *22151515*. Desde nuestro Call Center te atenderemos¬†con¬†gusto."
            }
          }
        ],
        "transitions": [],
        "transition_delay": -1
      },
      {
        "key": "prueba",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°Listo! üòâ Este es el nombre que guardar√©:   *Nombre*: {{userFullName}}"
            }
          }
        ],
        "transitions": [],
        "transition_delay": -1
      },
      {
        "key": "cierre-festivo",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "En este momento nuestros agentes est√°n fuera de horario de atenci√≥n.\n\n*\"Te comentamos que este viernes 18 y s√°bado 19 cerramos nuestro servicio a las 8:00pm.\"*"
            }
          }
        ],
        "transitions": [],
        "transition_delay": -1
      },
      {
        "key": "bh-bot",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "init",
            "type": "script",
            "params": {
              "params": {
                "body": {},
                "method": "POST",
                "headers": {},
                "endpoint": "https://d9rsao4hm4.execute-api.us-east-1.amazonaws.com/staging/business"
              },
              "script": "yumpii-bot-middleware-prod-executeEndpoint"
            },
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "FAQ start",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "param": {
              "code": "if (context.userQuestion) {\ncontext.set(\"nextStep\", 73)\n}else{\ncontext.set(\"nextStep\",72)\n}"
            }
          },
          {
            "type": "script",
            "params": {
              "params": {
                "code": "-- Check if userQuestion exists in the Context\n\nif Context.check(\"userQuestion\") then\n    -- Search for an answer\n    Workflow.branch(73)\nelse\n    -- Get question\n    Workflow.branch(72)\nend"
              },
              "script": "custom_script"
            }
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "FAQ get question",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Por favor, escribe tu consulta en un *solo mensaje*."
            }
          }
        ],
        "transitions": [
          {
            "next": "FAQ search answer",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "FAQ search answer",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "go to pedido",
            "type": "script",
            "params": {
              "params": {
                "body": {},
                "method": "POST",
                "headers": {},
                "endpoint": "https://api-global.yalochat.com/brain/v1/feedback"
              },
              "script": "yumpii-bot-middleware-prod-executeEndpoint"
            },
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "FAQ found answer",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "*{{faqMatchQuestion}}*\n\n{{faqMatchAnswer}}"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "S√≠  ‚úÖ"
                },
                {
                  "id": "string",
                  "title": "No üö´"
                }
              ],
              "bodyText": "¬øMi respuesta te ayud√≥?",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "type": "script",
            "params": {
              "params": {
                "code": "Context.delete(\"userQuestion\")"
              },
              "script": "custom_script"
            }
          },
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|regresar|atras|iniciar|regrezar|volver|empezar",
            "variable_replace": {}
          },
          {
            "next": "FAQ successfully answered",
            "type": "contains",
            "value": "si|yes",
            "variable_replace": {}
          },
          {
            "next": "FAQ unsuccessfully answered",
            "type": "contains",
            "value": "no",
            "variable_replace": {}
          },
          {
            "type": "script",
            "params": {
              "params": {
                "code": "-- Get user message\nmessage = Context.get(\"userMessage\")\n\n-- Get only the number from the user message\n-- \"I want option 2\" returns \"2\"\nselection = String.onlyNumbers(message)\n\n-- Get questions saved in previous step\nquestions = Context.get(\"faqQuestions\")\n\nif Context.check(\"faqQuestions\") then\n    -- Convert JSON to Lua Table (Object)\n    questions = JSON.decode(questions)\n    \n    -- Loop through the questions searching if the number entered by user\n    -- matches any of the questions\n    for key, question in pairs(questions) do\n        -- If question index matches number entered by user\n        if question.index == selection then\n            Context.set(\"faqMatchId\", question.id)\n            Context.set(\"faqMatchQuestion\", question.title)\n            Context.set(\"faqMatchAnswer\", question.content)\n            Workflow.branch(74) \n        end\n    end\nend"
              },
              "script": "custom_script"
            }
          },
          {
            "next": "get-webview-parameters",
            "type": "contains",
            "value": "pedido|hacer pedido|pedir|desayuno|breakfast",
            "variable_replace": {}
          },
          {
            "next": "business-hours",
            "type": "contains",
            "value": "agente|ajente|asesor|acesor|humano|persona|ayuda|help|aiuda|alluda",
            "variable_replace": {}
          },
          {
            "next": "new-addresess",
            "type": "contains",
            "value": "nueva direccion|direccion|ubicacion|nueva|cambiar direccion",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "FAQ found multiple questions",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Tengo las siguientes preguntas relacionadas a tu consulta üëáüèº\n\n{{#each faqQuestions}}\n{{index}}) {{title}}\n{{/each}}\n\nEscribe *el n√∫mero* de la pregunta que quieres que te responda.\n\n_Ejemplo: 4_"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Ninguna  ‚ùå"
                }
              ],
              "bodyText": "Si tu pregunta no se encuentra en el listado selecciona la palabra *Ninguna*",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "FAQ unsuccessfully answered",
            "type": "contains",
            "value": "ninguna",
            "variable_replace": {}
          },
          {
            "type": "script",
            "params": {
              "params": {
                "code": "-- Get user message\nmessage = Context.get(\"userMessage\")\n\n-- Get only the number from the user message\n-- \"I want option 2\" returns \"2\"\nselection = String.onlyNumbers(message)\n\n-- Get questions saved in previous step\nquestions = Context.get(\"faqQuestions\")\n\n-- Ensure the Context variable exists\nif Context.check(\"faqQuestions\") then\n    -- Convert JSON to Lua Table (Object)\n    questions = JSON.decode(questions)\n    \n    -- Loop through the questions searching if the number entered by user\n    -- matches any of the questions\n    for key, question in pairs(questions) do\n        -- If question index matches number entered by user\n        if question.index == selection then\n            Context.set(\"faqMatchId\", question.id)\n            Context.set(\"faqMatchQuestion\", question.title)\n            Context.set(\"faqMatchAnswer\", question.content)\n            Workflow.branch(74) \n        end\n    end\nend"
              },
              "script": "custom_script"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "FAQ found no question",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "No encontr√© una respuesta a tu pregunta üòØ"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Men√∫ ü•ñ "
                },
                {
                  "id": "string",
                  "title": "Hablar con asesor"
                }
              ],
              "bodyText": "Si deseas puedes escribir *otra pregunta* a continuaci√≥n o selecciona *Men√∫* para regresar al inicio.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "type": "script",
            "params": {
              "params": {
                "code": "Context.delete(\"userQuestion\")"
              },
              "script": "custom_script"
            }
          },
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|regresar|atras|iniciar|regrezar|volver|empezar",
            "variable_replace": {}
          },
          {
            "next": "hiAgain",
            "type": "contains",
            "value": "hola|ola|oli|holi|holo|hi|hey|hello|que onda|ondiux|quiubole|que hubo|hubo|uvas|honduras|onduras|bonjour|buenas tardes|buenos d√≠as|buenas noches|buen dia|buena tarde|buena noche",
            "variable_replace": {}
          },
          {
            "next": "bye",
            "type": "contains",
            "value": "bye|bai|good bye|adi√≥s|bay|adios|ciao|chao|camara|c√°mara|hasta pronto|hasta lueg|hasta luego|nos vemos|bye!|bai!|adi√≥s!|bay!|adios!|ciao!|chao!|camara!|c√°mara!|hasta pronto!|hasta lueg!|hasta luego!|nos vemos!",
            "variable_replace": {}
          },
          {
            "next": "yourWelcome",
            "type": "contains",
            "value": "gracias|super|orale|√≥rale|grasias|grazias|graxs|grax|s√∫per|thanks|thank|thank",
            "variable_replace": {}
          },
          {
            "next": "business-hours",
            "type": "contains",
            "value": "asesor|agente|ayuda|hablar con alguien",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "FAQ successfully answered",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°Perfecto! üòâ"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Men√∫ ü•ñ"
                }
              ],
              "bodyText": "Si deseas puedes escribir *otra pregunta* a continuaci√≥n o selecciona *Men√∫* para regresar al inicio.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "type": "script",
            "params": {
              "params": {
                "code": "Context.delete(\"userQuestion\")"
              },
              "script": "custom_script"
            }
          },
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|regresar|atras|iniciar|regrezar|volver|empezar",
            "variable_replace": {}
          },
          {
            "next": "hiAgain",
            "type": "contains",
            "value": "hola|ola|oli|holi|holo|hi|hey|hello|que onda|ondiux|quiubole|que hubo|hubo|uvas|honduras|onduras|bonjour|buenas tardes|buenos d√≠as|buenas noches|buen dia|buena tarde|buena noche|buenas",
            "variable_replace": {}
          },
          {
            "next": "bye",
            "type": "contains",
            "value": "bye|bai|good bye|adi√≥s|bay|adios|ciao|chao|camara|c√°mara|hasta pronto|hasta lueg|hasta luego|nos vemos|bye!|bai!|adi√≥s!|bay!|adios!|ciao!|chao!|camara!|c√°mara!|hasta pronto!|hasta lueg!|hasta luego!|nos vemos!",
            "variable_replace": {}
          },
          {
            "next": "yourWelcome",
            "type": "contains",
            "value": "gracias|super|orale|√≥rale|grasias|grazias|graxs|grax|s√∫per|thanks|thank|thank",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "FAQ unsuccessfully answered",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Lamento no poderte ayudar, seguir√© aprendiendo. ‚òùüèº"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Men√∫ ü•ñ"
                }
              ],
              "bodyText": "Si deseas puedes escribir *otra pregunta* a continuaci√≥n o selecciona *Men√∫* para regresar al inicio.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "type": "script",
            "params": {
              "params": {
                "code": "Context.delete(\"userQuestion\")"
              },
              "script": "custom_script"
            }
          },
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|regresar|atras|iniciar|regrezar|volver|empezar",
            "variable_replace": {}
          },
          {
            "next": "hiAgain",
            "type": "contains",
            "value": "hola|buenas tardes|buenos d√≠as|buen d√≠a|buenas noches|buen dia|disculpe|hola buena tarde|hola buenas tardes|hola buen dia|hola buenos dias|buenos dias|hola buena tarde",
            "variable_replace": {}
          },
          {
            "next": "bye",
            "type": "contains",
            "value": "bye|bai|good bye|adi√≥s|bay|adios|ciao|chao|camara|c√°mara|hasta pronto|hasta lueg|hasta luego|nos vemos|bye!|bai!|adi√≥s!|bay!|adios!|ciao!|chao!|camara!|c√°mara!|hasta pronto!|hasta lueg!|hasta luego!|nos vemos!",
            "variable_replace": {}
          },
          {
            "next": "yourWelcome",
            "type": "contains",
            "value": "gracias|super|orale|√≥rale|grasias|grazias|graxs|grax|s√∫per|thanks|thank|thank",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "FAQ no valid option fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "No elegiste una opci√≥n v√°lida üòß, por favor intentalo de nuevo.\n\n_Escribe el *n√∫mero* de la opci√≥n._"
            }
          }
        ],
        "transitions": [
          {
            "next": "FAQ found multiple questions",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "go to pedido",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Escribe aqu√≠ la palabra *Desayuno* y as√≠ empezar con tu pedido. üòã"
            }
          }
        ],
        "transitions": [
          {
            "next": "bh-before-pedido",
            "type": "contains",
            "value": "desayuno|ver menu de desayuno|ver menu|ver desayunos|desayunos",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "go to asesor",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Escribe aqu√≠ la palabra *Ayuda*, para que uno de nuestros compa√±eros pueda apoyarte. ü§ì"
            }
          }
        ],
        "transitions": [
          {
            "next": "business-hours",
            "type": "contains",
            "value": "ayuda |asesor|agente|hablar con humano",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "greeting",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°Genial! iniciemos el pedido."
            }
          }
        ],
        "transitions": [
          {
            "type": "auto",
            "delay": 0,
            "next": "validate-customer",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "validate-customer",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "<<VALIDATE CUSTOMER>>"
            }
          }
        ],
        "transitions": [
          {
            "next": "set-order-type",
            "type": "script",
            "delay": 0,
            "params": {
              "params": {
                "method": "POST",
                "body": {
                  "code": "function validateRegister() {\n  let customer = {};\n  const customerData = context.customer;\n\n  if (customerData !== null && customerData !== undefined) {\n    customer = JSON.parse(customerData);\n  }\n\n  if (\n    customer.fullName !== null &&\n    customer.fullName !== undefined &&\n    customer.fullName !== \"\" &&\n    customer.userEmail !== null &&\n    customer.userEmail !== undefined &&\n    customer.userEmail !== \"\"\n  ) {\n    Context.set(\"nextStep\", \"set-order-type\");\n    return;\n  }\n\n  Context.set(\"nextStep\", \"new-user\");\n}\n\ntry {\n  validateRegister();\n} catch (err) {\n  Context.set(\"nextStep\", 123);\n}\n",
                  "transitions": {
                    "success": "new-user",
                    "error": "new-user",
                    "set-order-type": "set-order-type",
                    "new-user": "new-user"
                  }
                },
                "headers": {},
                "endpoint": "https://lqiduilpni.execute-api.us-east-1.amazonaws.com/dev/executeScript",
                "appendContext": true,
                "appendProfile": true
              },
              "script": "yumpii-bot-middleware-prod-executeEndpoint"
            }
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "delivery-pickup",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "A domicilio üõµ"
                },
                {
                  "id": "string",
                  "title": "En restaurante üç¥"
                }
              ],
              "bodyText": "¬øC√≥mo ser√° tu pedido?",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "validate-customer",
            "type": "contains",
            "value": "a domicilio|1|uno|one|1Ô∏è‚É£|domicilio|a domicilio|domisilio|en casa|casa|vienen|llevarmelo|llevan",
            "variable_replace": {
              "tipoPedido": "Delivery"
            }
          },
          {
            "next": "validate-customer",
            "type": "contains",
            "value": "2|dos|two|2Ô∏è‚É£|recoger|recojer|restaurante|recoleccion|recolecci√≥n|recolexion|sucursal|para recoger|para recojer|pickup|pick up|para llevar|llevar|en restaurante|ventanilla|autoservicio| auto servicio",
            "variable_replace": {
              "tipoPedido": "Pickup"
            }
          },
          {
            "next": "menu",
            "type": "contains",
            "value": "men√∫|menu|regresar|inicio|inisio|regrezar|salir|empezar|comienzo|principio|pedir|ordenar|opciones",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "delivery-pickup-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬øMe repites la opci√≥n con la que deseas continuar?\n\n1Ô∏è‚É£ Pedido a *domicilio* üõµ\n2Ô∏è‚É£ Para *recoger* en restaurante üç¥\n\nEscriba el *n√∫mero* de la opci√≥n."
            }
          }
        ],
        "transitions": [
          {
            "next": "validate-customer",
            "type": "contains",
            "value": "1|uno|one|1Ô∏è‚É£|domicilio|a domicilio|domisilio|en casa|casa|vienen|llevarmelo|llevan",
            "variable_replace": {
              "tipoPedido": "Delivery"
            }
          },
          {
            "next": "validate-customer",
            "type": "contains",
            "value": "2|dos|two|2Ô∏è‚É£|recoger|recojer|restaurante|recoleccion|recolecci√≥n|recolexion|sucursal|para recoger|para recojer|pickup|pick up|para llevar|llevar|en restaurante|ventanilla|autoservicio| auto servicio",
            "variable_replace": {
              "tipoPedido": "Pickup"
            }
          },
          {
            "next": "menu",
            "type": "contains",
            "value": "men√∫|menu|regresar|inicio|inisio|regrezar|salir|empezar|comienzo|principio|pedir|ordenar|opciones",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "set-order-type",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "<<SET ORDER TYPE>>"
            }
          }
        ],
        "transitions": [
          {
            "next": "check-addresses",
            "type": "auto",
            "variable_replace": {
              "deliveryMethod": "delivery"
            },
            "position": 0
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "check-addresses",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "<<CHECK ADDRESS>>"
            }
          }
        ],
        "transitions": [
          {
            "next": "",
            "type": "script",
            "delay": 0,
            "params": {
              "params": {
                "checkSingleBranch": true
              },
              "script": "yumpii-bot-middleware-prod-getAddresses",
              "transitions": {
                "no-address": "get-location",
                "multi-address": "same-address-delivery",
                "single-address": "same-address-delivery",
                "pickup-new-location": "get-location-pickup"
              }
            },
            "position": 0
          }
        ],
        "transition_delay": 1
      },
      {
        "key": "same-address-delivery",
        "content": [
          {
            "type": "button",
            "value": {
              "footerText": "Para agregar una nueva direcci√≥n, selecciona Nueva.",
              "buttons": [
                {
                  "id": "d46a5fc9-fcf8-4ca0-8cb9-7509fd0cd7d6",
                  "title": "Nueva"
                }
              ]
            },
            "caption": "¬øD√≥nde deseas que entreguemos tu pedido? üëáüèªüòä\n\nEscribe el n√∫mero de la direcci√≥n a la que quieres que se entregue tu pedido (Ej. 1). \n\n{{#each customer.addresses}}\n{{this.position}}. {{this.fullAddress}}\n{{/each}}"
          }
        ],
        "transitions": [
          {
            "position": 0,
            "type": "regex",
            "value": "^(menu|men√∫)$",
            "variable_replace": {},
            "next": "menu"
          },
          {
            "position": 1,
            "type": "regex",
            "value": "^(regresar|atr√°s|atras|me equivoque|otro|otra|regreso)$",
            "variable_replace": {},
            "next": "delivery-pickup"
          },
          {
            "position": 2,
            "type": "regex",
            "value": "([^\\w][\\\\u00C0-\\\\u00FF]+|^)(^(?:[1-9]|10))($|\\.)",
            "variable_replace": {
              "chosenAddressDelivery": "{{context.userMessage.content.text}}"
            },
            "next": "validate-store"
          },
          {
            "position": 3,
            "type": "regex",
            "value": "^(si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|su|exacto|yes|yep|confirmo|confirmado|confirmar|correcto)$",
            "variable_replace": {
              "chosenAddressDelivery": "{{context.userMessage.content.text}}"
            },
            "next": "validate-store"
          },
          {
            "position": 4,
            "type": "regex",
            "value": "^(nueva|otro|otra|nuevo|diferente)$",
            "variable_replace": {},
            "next": "new-addresess"
          },
          {
            "position": 5,
            "type": "regex",
            "value": "^(no|nel|no|nely|nelly|√±o|norton|momento|despu√©s|noo|nop|nooop)$",
            "variable_replace": {},
            "next": "new-addresess"
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "get-location-pickup-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Recuerda que debes enviarme tu ubicaci√≥n actual o la ubicaci√≥n donde deseas recoger tu pedido. üìç"
            }
          },
          {
            "type": "text",
            "value": {
              "text": "En *IOS* pulsa el bot√≥n con el √≠cono \\\"+\\\"  _(lo encuentras en la esquina inferior izquierda)_\nEn *Android* pulsa el bot√≥n con el √≠cono  \\\"üìé\\\"  _(lo encuentras en la esquina inferior derecha)_"
            }
          }
        ],
        "transitions": [
          {
            "next": "sistema-pk",
            "type": "contains",
            "value": "tutorial|tuto|tutoria|ayuda|ubicaci√≥n|ubicacion|necesito ayuda",
            "variable_replace": {}
          },
          {
            "next": "menu",
            "type": "contains",
            "value": "men√∫|menu|regresar|atr√°s|atras|cambiar|me equivoque|otro|otra|llevar|para llevar|regreso",
            "variable_replace": {}
          },
          {
            "next": "get-branch-pickup",
            "type": "format",
            "value": "location",
            "variable_replace": {
              "userLocation": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "get-location",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "{{#if isPickup}}Comp√°rteme tu ubicaci√≥n actual o la ubicaci√≥n donde deseas recoger tu pedido. üìç Esto es para verificar que cuentes con cobertura. üòâ{{else}}Verifiquemos que cuentes con cobertura üòä Comp√°rteme la ubicaci√≥n donde quieres que entreguemos tu pedido üìç{{/if}}\n\n_*Recuerda* que s√≥lo puedes compartir tu ubicaci√≥n desde el celular. üì≤_"
            }
          },
          {
            "type": "button",
            "value": {
              "footerText": "",
              "buttons": [
                {
                  "id": "2380e280-fe55-49b3-a36c-724925f3449f",
                  "title": "Tutorial"
                }
              ]
            },
            "caption": "Si tienes duda de c√≥mo enviar tu ubicaci√≥n, selecciona la palabra *tutorial* y con gusto te muestro. üòä"
          }
        ],
        "transitions": [
          {
            "position": 0,
            "type": "regex",
            "value": "^(tutorial|no se|no s√©|no lo encuentro|no la encuentro|donde esta|d√≥nde est√°|como le hago|c√≥mo le hago|como le ago|como|c√≥mo|no puedo)$",
            "variable_replace": {},
            "next": "sistema"
          },
          {
            "position": 1,
            "type": "regex",
            "value": "^(regresar|atr√°s|atras|cambiar|me equivoque|otro|otra|llevar|para llevar|regreso)$",
            "variable_replace": {},
            "next": "delivery-pickup"
          },
          {
            "position": 2,
            "type": "auto",
            "delay": 0,
            "variable_replace": {
              "userLocation": "{{context.userMessage.content.text}}"
            },
            "next": "store-locator"
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "sistema",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "ü§ñ Android "
                },
                {
                  "id": "string",
                  "title": "üì± IOS (iPhone)"
                }
              ],
              "bodyText": "¬øQu√© sistema tiene tu tel√©fono? ",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "android",
            "type": "contains",
            "value": "1|uno|one|onu|1Ô∏è‚É£|android|androide|samsung|samsun|huawei|guawei|motorola|alcatel|lg|zte|sony|xiaomi|xhaomi|shaomi|chiaomi|ü§ñ",
            "variable_replace": {}
          },
          {
            "next": "iphone",
            "type": "contains",
            "value": "2|dos|two|2Ô∏è‚É£|dous|iphone|i phone|ifon|i fon|aios|ios|i os|apol|apel|apple|mac|aifon|aiphone|aifone|üì±",
            "variable_replace": {}
          },
          {
            "next": "store-locator",
            "type": "format",
            "value": "location",
            "variable_replace": {
              "userLocation": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "store-locator",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "<<STORE LOCATOR>>"
            }
          }
        ],
        "transitions": [
          {
            "next": "",
            "type": "script",
            "delay": 0,
            "params": {
              "script": "yumpii-bot-middleware-prod-locateBranch",
              "params": {
                "deliveryMethod": "delivery"
              }
            },
            "position": 0
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "get-location-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Para continuar, necesitamos verificar la cobertura de nuestros servicios a trav√©s de tu ubicaci√≥n. üëáüèºüòä"
            }
          },
          {
            "type": "text",
            "value": {
              "text": "En *IOS* pulsa el bot√≥n con el √≠cono *+*  _(lo encuentras en la esquina inferior izquierda)_\nEn *Android* pulsa el bot√≥n con el √≠cono üìé  _(lo encuentras en la esquina inferior derecha)_"
            }
          }
        ],
        "transitions": [
          {
            "next": "sistema",
            "type": "contains",
            "value": "tutorial|no se|no s√©|no lo encuentro|no la encuentro|donde esta|d√≥nde est√°|como le hago|c√≥mo le hago|como le ago|como|c√≥mo|no puedo",
            "variable_replace": {}
          },
          {
            "next": "store-locator",
            "type": "format",
            "value": "location",
            "variable_replace": {
              "userLocation": "{{context.userMessage.content.text}}"
            }
          },
          {
            "next": "delivery-pickup",
            "type": "contains",
            "value": "regresar|atr√°s|atras|cambiar|me equivoque|otro|otra|llevar|para llevar|regreso",
            "variable_replace": {}
          },
          {
            "next": "error-validate-store",
            "type": "contains",
            "value": "error-store",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "android",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Sigue las instrucciones de la imagen y comp√°rteme la ubicaci√≥n a d√≥nde quieres que enviemos tu pedido üìç"
            }
          },
          {
            "type": "image",
            "value": {
              "url": "https://yalo-images.s3.us-west-1.amazonaws.com/Tutorial-AndoridUX.png",
              "caption": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|men√∫|regresar|at√°s|atras|iniciar|regrezar|volver|empezar",
            "variable_replace": {}
          },
          {
            "next": "store-locator",
            "type": "format",
            "value": "location",
            "variable_replace": {
              "userLocation": "{{context.userMessage.content.text}}"
            }
          },
          {
            "next": "iphone",
            "type": "contains",
            "value": "iphone|i phone|ifon|i fon|aios|ios|i os|apol|apel|apple|mac|aifon|aiphone|aifone|üì±",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "iphone",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Sigue las instrucciones de la imagen y comp√°rteme la ubicaci√≥n a d√≥nde quieres que enviemos tu pedido üìç"
            }
          },
          {
            "type": "image",
            "value": {
              "url": "https://yalo-images.s3.us-west-1.amazonaws.com/Tutorial-IOSUX.png",
              "caption": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|men√∫|regresar|at√°s|atras|iniciar|regrezar|volver|empezar",
            "variable_replace": {}
          },
          {
            "next": "store-locator",
            "type": "format",
            "value": "location",
            "variable_replace": {
              "userLocation": "{{context.userMessage.content.text}}"
            }
          },
          {
            "next": "android",
            "type": "contains",
            "value": "android|androide|samsung|samsun|huawei|guawei|motorola|alcatel|lg|zte|sony|xiaomi|xhaomi|shaomi|chiaomi|ü§ñ",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "sistema-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "ü§î No creo haberte entendido... "
            }
          },
          {
            "type": "text",
            "value": {
              "text": "¬øMe repites tu respuesta?\n\n1Ô∏è‚É£ Android\n2Ô∏è‚É£ iOS (iPhone)"
            }
          }
        ],
        "transitions": [
          {
            "next": "android",
            "type": "contains",
            "value": "1|uno|one|onu|1Ô∏è‚É£|android|androide|samsung|samsun|huawei|guawei|motorola|alcatel|lg|zte|sony|xiaomi|xhaomi|shaomi|chiaomi|ü§ñ",
            "variable_replace": {}
          },
          {
            "next": "iphone",
            "type": "contains",
            "value": "2|dos|two|2Ô∏è‚É£|dous|iphone|i phone|ifon|i fon|aios|ios|i os|apol|apel|apple|mac|aifon|aiphone|aifone|üì±",
            "variable_replace": {}
          },
          {
            "next": "store-locator",
            "type": "format",
            "value": "location",
            "variable_replace": {
              "userLocation": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "no-branch-available",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°Oh oh! üò≤ No tengo disponible un restaurante cercano a tu ubicaci√≥n."
            }
          },
          {
            "type": "button",
            "value": {
              "footerText": "",
              "buttons": [
                {
                  "id": "1579d3dd-f0b7-4e9d-a6f7-6a6897c79988",
                  "title": "S√≠ ‚úÖ"
                },
                {
                  "id": "ef0ccbac-5b3d-4529-a623-c76dbf8a9db5",
                  "title": "Men√∫"
                }
              ]
            },
            "caption": "¬øDeseas intentar ingresar una ubicaci√≥n nuevamente? \n\nSelecciona la palabra *s√≠* para volver a intentarlo √≥ selecciona *men√∫* para regresar al inicio."
          }
        ],
        "transitions": [
          {
            "position": 0,
            "type": "regex",
            "value": "^(S√≠ ‚úÖ|si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|1|uno|one|va)$",
            "variable_replace": {},
            "next": "get-location"
          },
          {
            "position": 1,
            "type": "regex",
            "value": "^(men√∫|menu|regresar|inicio|inisio|regrezar|salir|empezar|comienzo|principio|pedir|ordenar|opciones)$",
            "variable_replace": {},
            "next": "menu"
          },
          {
            "position": 2,
            "type": "auto",
            "delay": 0,
            "value": "location",
            "variable_replace": {
              "userLocation": "{{context.userMessage.content.text}}"
            },
            "next": "store-locator"
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "new-address-reference",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Muy bien, ahora comp√°rteme tu direcci√≥n completa en una sola l√≠nea. Incluye *calle, avenida, zona, colonia, c√≥digo de acceso, municipio y departamento*, para encontrarte m√°s r√°pido. üó∫ \n\n_(Ejemplo: 5ta calle 12-40 zona 10, colonia El Valle, c√≥digo de ingreso 550. Guatemala, Guatemala)_"
            }
          }
        ],
        "transitions": [
          {
            "position": 0,
            "type": "regex",
            "value": "^(est√∫pida|estupida|in√∫til|inutil|perra|zorra|cabrona|pendeja|bruta|burra|mula|cerota|puta|idiota|cabron|pendejo|cabr√≥n|chinga|chingan|chingas|chingon|chingada|chingadas|jode|jodes|jodidos|jodiendo|jodo|kulero|mamadas|mames|mams|mam√≥n|mierda|mierda|mierdas|ni madres|pendeja|pendeja|pendejas|pendejo|pendejo|pendejos|pinche|pinches|ptm|puta|puta|putos|hdp|culero|putero|fuck|asshole|rateros|ratas|joto|joterias|joter√≠as|caca|kaka|cagado|cagados|idiota|esperma|sperma|vagina|menstruaci√≥n|sexo|pucha|puchita|panocha|panochon|nepe|pito|pitos|pitero|putero|putas|puterias|puter√≠as|puto|ratas|shinga|shingas|shingon|shing√≥n|shit|spm|verga|hdp|cagar|cagas|chinga|chingas|chingada|chingado|chingadoo|chingalos|chingao|chingaos|chingar|chingarlos|chingarnos|chingarte|chingate|chingatelos|chingo|chingon|chinguen|ching√≥n|ch√≠ngalos|ch√≠ngate|ch√≠ngatelos|orgullo.com|condon|condones|cond√≥n|cojon|coj√≥n|culera|culeras|culero|culeros|culo|joder|madrear|mamada|mamadas|mamar|mamarracho|mamen|mames|mamez|mamon|mam√≥n|maricon|maric√≥n|mierda|mojon|moj√≥n|ogete|ogetes|ojete|ojetes|pedorro|pendeja|pendejada|pendejadas|pendejas|pendejo|pinche|pinches|pinga|pito|pitos|puta|putas|putisima|putisimas|putisimo|putisimos|puto|putos|put√≠sima|put√≠simas|put√≠simo|put√≠simos|pu√±al|pu√±ales|pu√±etas|pu√±eta|shingaa|putazo|pendejo|pendeja|pendejos|pendejotes|pendejas|chingado|cabron|chinga|culera|mamar|mamen|kabron|jodido|pinches|pito|ratas|marika|rreputa|reputisima|cerote|punal|joder|idiota|estupido|est√∫pido|mierda|putos|porno|nudes|desnudo|desnudos|pendejos|torpe|tonto|mamar|chingada|malditos|maldito|pendejos|tarado|masturbar|masturbando|masturbaci√≥n|masturbacion|masturbasion|marturbame|mast√∫rbame|masturvando|masturvar|masturb√°ndome|masturvandome|chaqueta|chaqueteando|jalando|jal√°ndomela|jalandomela|masturbandome|pajiando|pajas|paja|mestruar|menstruacion|menstruaci√≥n|menstruasion|menstruasi√≥n|tengo la regla|me vino|me vine|sexo|sexual|porno|coger|cojer|cogida|cojida|semen|pene|culo|culos|ano|nalga|nalgas|seno|senos|chiche|chiches|chichi|chichis|pechos|tetas|teta|caca|orinar|fisting)$",
            "variable_replace": {},
            "next": "get-address-reference-fallback"
          },
          {
            "position": 1,
            "type": "regex",
            "value": "^([A-Z√°√©√≠√≥√∫√Å√â√ç√ì√ö√±√ëa-z\\u00C0-\\u00FF0-9\\s\\,\\.\\#\\-\\_\\+\\;\\:\\&\\*\\=]|(\\u00a9|\\u00ae|[\\u2000-\\u3300]|\\ud83c[\\ud000-\\udfff]|\\ud83d[\\ud000-\\udfff]|\\ud83e[\\ud000-\\udfff])){15,120}$",
            "variable_replace": {
              "addressReference": "{{context.userMessage.content.text}}"
            },
            "next": "confirm-address-reference"
          },
          {
            "position": 2,
            "type": "auto",
            "delay": 0,
            "variable_replace": {},
            "next": "confirm-address-reference"
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "confirm-address-reference",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Entregaremos tu pedido en: {{context.addressReference}}"
            }
          },
          {
            "type": "button",
            "value": {
              "footerText": "",
              "buttons": [
                {
                  "id": "69e0b2e5-06d5-47cc-a3c9-9b7d6500ee8e",
                  "title": "S√≠ ‚úÖ"
                },
                {
                  "id": "102b2352-71f9-4931-bf4f-61918489334d",
                  "title": "No üö´"
                }
              ]
            },
            "caption": "¬øTus datos son correctos?"
          }
        ],
        "transitions": [
          {
            "position": 0,
            "type": "regex",
            "value": "^(si.*|s√≠.*|si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|1|uno|one|va)$",
            "variable_replace": {},
            "next": "selected-store"
          },
          {
            "position": 1,
            "type": "regex",
            "value": "^(no.*|nel|no|nely|nelly|√±o|norton)$",
            "variable_replace": {},
            "next": "ok-reference"
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "No-branches-found-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°Ups! No comprend√≠ tu mensaje, escribe la palabra *s√≠* para intentarlo nuevamente o escribe *no* para regresar a inicio."
            }
          }
        ],
        "transitions": [
          {
            "next": "get-location",
            "type": "contains",
            "value": "si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|1|uno|one|va",
            "variable_replace": {}
          },
          {
            "next": "menu",
            "type": "contains",
            "value": "no|nel|no!|nely|nelly|√±o|norton|negativo|malo|malo|mal|incorrecto|incorrecta|equivocado|equivocada|negative|bad|wrong|not|nay|√±ao|ruim|errado|incorreto",
            "variable_replace": {}
          },
          {
            "next": "store-locator",
            "type": "format",
            "value": "location",
            "variable_replace": {
              "userLocation": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "selected-store",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°Listo! *San Mart√≠n {{context.selectedBranch.name}}* te estar√° preparando el pedido. ü§©"
            }
          }
        ],
        "transitions": [
          {
            "position": 0,
            "type": "auto",
            "delay": 0,
            "variable_replace": {},
            "next": "save-new-address"
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "ok-reference",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "De acuerdo! Intent√©moslo nuevamente üòâ"
            }
          }
        ],
        "transitions": [
          {
            "next": "get-address-reference",
            "variable_replace": {}
          }
        ],
        "transition_delay": 2
      },
      {
        "key": "confirm-address-reference-fallba",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Disculpa no he comprendido tu mensaje. Escribe √∫nicamente *Si* o *No* para confirmar tu direcci√≥n. "
            }
          }
        ],
        "transitions": [
          {
            "next": "selected-store",
            "type": "contains",
            "value": "si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|1|uno|one|va",
            "variable_replace": {}
          },
          {
            "next": "ok-reference",
            "type": "contains",
            "value": "no|nel|no|nely|nelly|√±o|norton",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "save-new-address",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "<<SAVE NEW ADDRESS>>"
            }
          }
        ],
        "transitions": [
          {
            "next": "",
            "type": "script",
            "delay": 0,
            "params": {
              "script": "yumpii-bot-middleware-prod-saveNewAddress",
              "transitions": {
                "address-saved": "get-webview-parameters"
              }
            },
            "position": 0
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "error-new-address",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Lo lamento üòß, ocurri√≥ un error al guardar tus datos, intent√©moslo nuevamente."
            }
          }
        ],
        "transitions": [
          {
            "next": "get-location",
            "variable_replace": {}
          }
        ],
        "transition_delay": 2
      },
      {
        "key": "validate-store",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Estoy verificando con el restaurante, dame unos segundos... ‚åõ"
            }
          }
        ],
        "transitions": [
          {
            "next": "script-select-address",
            "variable_replace": {}
          }
        ],
        "transition_delay": 2
      },
      {
        "key": "new-addresess",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Entendido üòâ Actualizaremos tus datos.\n\n_Ingresa los datos solicitados una vez y quedar√°n registrados para tu pr√≥xima compra._"
            }
          }
        ],
        "transitions": [
          {
            "next": "get-location",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "fallback-same-address-delivery",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Nueva direcci√≥n"
                }
              ],
              "bodyText": "¬øMe puedes repetir tu respuesta? ü§î\n\nEscribe el *n√∫mero* de la direcci√≥n a la que quieres que se entregue tu pedido *(Ejemplo. 1)*.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|men√∫",
            "variable_replace": {}
          },
          {
            "next": "delivery-pickup",
            "type": "contains",
            "value": "regresar|atr√°s|atras|me equivoque|otro|otra|regreso",
            "variable_replace": {}
          },
          {
            "next": "validate-store",
            "type": "regex",
            "value": "([^\\w][\\√Ä-\\√ø]+|^)(^(?:[1-9]|10))($|\\.)",
            "variable_replace": {
              "chosenAddressDelivery": "{{context.userMessage.content.text}}"
            }
          },
          {
            "next": "validate-store",
            "type": "contains",
            "value": "si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|su|exacto|yes|yep|confirmo|confirmado|confirmar|correcto",
            "variable_replace": {
              "chosenAddressDelivery": "{{context.userMessage.content.text}}"
            }
          },
          {
            "next": "new-addresess",
            "type": "contains",
            "value": "nueva|otro|otra|nuevo|diferente|nueva direcci√≥n|nueva direccion",
            "variable_replace": {}
          },
          {
            "next": "new-addresess",
            "type": "contains",
            "value": "no|nel|no|nely|nelly|√±o|norton|momento|despu√©s|noo|nop|nooop",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "script-select-address",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "type": "script",
            "params": {
              "params": {
                "code": "function selectOption ()\n    local option = tonumber(Context.get('chosenAddressDelivery'))\n    local customer = {}\n    local customerData = Context.get('customer')\n    if customerData ~= nil then\n       customer = JSON.decode(customerData) \n    end\n    \n    if option > 0  and #customer.addresses >= option then\n        local selectedAddress = customer.addresses[option]\n        Context.set('selectedAddress', selectedAddress)\n        local deliveryMethod = Context.get('deliveryMethod')\n        \n        local base = Context.get('genericYalu')\n        local slug = Context.get('slug')\n        local timezone = Context.get('timezone')\n        \n        local url = base .. '/' .. slug .. '/branches'\n        -- Debug.print(url)\n        local body = {\n            location = selectedAddress.location.lat .. ',' .. selectedAddress.location.lng,\n            deliveryMethod = deliveryMethod,\n            timezone = timezone,\n            distance = 3000,\n            maxResults = 1\n        }\n        -- Debug.print(body)\n        result = HTTP.post(url, body)\n        Context.set('responseGeBranch', result)\n        data = result.data\n        \n        if data.statusCode == 200 then\n            if #data.data > 0 then\n                if type(data.data) == 'userdata' then\n                        local selectedBranch = data.data[0]\n                        Context.set('selectedBranch', selectedBranch)    \n                    else\n                        local selectedBranch = data.data[1]\n                        Context.set('selectedBranch', selectedBranch)\n                    end\n                \n                Workflow.branch(109) -- locate-express-address\n            end\n            \n            Workflow.branch(108) -- error-validate-store\n        end\n    end\n    \n    Workflow.branch(108) -- error-validate-store\nend\n\nlocal status, err = pcall(selectOption)\n\nif (err) then\n   Debug.print(err)\n   Workflow.branch(108) -- error-validate-store\nend"
              },
              "script": "custom_script"
            }
          }
        ],
        "transition_delay": 1
      },
      {
        "key": "error-validate-store",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "No encontr√© la direcci√≥n seleccionada, por favor vuelve a intentarlo. üôåüèª"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Intentar"
                },
                {
                  "id": "string",
                  "title": "Otra"
                }
              ],
              "bodyText": "Si quieres ingresar una *nueva direcci√≥n,* selecciona *Otra.*",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "same-address-delivery",
            "type": "contains",
            "value": "intentar|otra vez",
            "variable_replace": {}
          },
          {
            "next": "new-addresess",
            "type": "contains",
            "value": "otra|nueva|new adresses|nueva direccion",
            "variable_replace": {}
          }
        ],
        "transition_delay": 2
      },
      {
        "key": "locate-express-address",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°Listo!  *{{selectedBranch.name}}* te estar√° preparando tu pedido. ü§©"
            }
          }
        ],
        "transitions": [
          {
            "next": "get-webview-parameters",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "get-branch-pickup",
        "content": [],
        "transitions": [],
        "transition_delay": 0
      },
      {
        "key": "get-location-pickup",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Comp√°rteme tu ubicaci√≥n actual o la ubicaci√≥n donde deseas recoger tu pedido. üìç\n\n*Recuerda* que solo puedes compartir tu ubicaci√≥n desde el celular. üì≤"
            }
          },
          {
            "type": "button",
            "value": {
              "footerText": "",
              "buttons": [
                {
                  "id": "8aaf7fd0-4620-4114-8cbf-f3804b9ecdfd",
                  "title": "Tutorial üé•"
                }
              ]
            },
            "caption": "Si tienes duda de c√≥mo enviar tu ubicaci√≥n, selecciona la palabra *tutorial* y con gusto te muestro. üòä"
          }
        ],
        "transitions": [
          {
            "position": 0,
            "type": "regex",
            "value": "^(tutorial|tuto|tutoria|ayuda|ubicaci√≥n|ubicacion|necesito ayuda)$",
            "variable_replace": {},
            "next": "sistema-pk"
          },
          {
            "position": 1,
            "type": "regex",
            "value": "^(men√∫|menu|regresar|atr√°s|atras|cambiar|me equivoque|otro|otra|llevar|para llevar|regreso)$",
            "variable_replace": {},
            "next": "menu"
          },
          {
            "position": 2,
            "type": "auto",
            "delay": 0,
            "variable_replace": {
              "userLocation": "{{context.userMessage.content.text}}"
            },
            "next": "get-branch-pickup"
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "sistema-pk",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "ü§ñ Android "
                },
                {
                  "id": "string",
                  "title": "üì± IOS (iPhone)"
                }
              ],
              "bodyText": "¬øQu√© sistema tiene tu tel√©fono? ",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "android-pk",
            "type": "contains",
            "value": "1|uno|one|onu|1Ô∏è‚É£|android|androide|samsung|samsun|huawei|guawei|motorola|alcatel|lg|zte|sony|xiaomi|xhaomi|shaomi|chiaomi|ü§ñ",
            "variable_replace": {}
          },
          {
            "next": "iphone-pk",
            "type": "contains",
            "value": "2|dos|two|2Ô∏è‚É£|dous|iphone|i phone|ifon|i fon|aios|ios|i os|apol|apel|apple|mac|aifon|aiphone|aifone|üì±",
            "variable_replace": {}
          },
          {
            "next": "get-branch-pickup",
            "type": "format",
            "value": "location",
            "variable_replace": {
              "userLocation": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "android-pk",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Sigue las instrucciones de la imagenüìç"
            }
          },
          {
            "type": "image",
            "value": {
              "url": "https://b2c-images-bucket.s3.ca-central-1.amazonaws.com/UX/andorid_generico.png",
              "caption": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|men√∫|regresar|at√°s|atras|iniciar|regrezar|volver|empezar",
            "variable_replace": {}
          },
          {
            "next": "get-branch-pickup",
            "type": "format",
            "value": "location",
            "variable_replace": {
              "userLocation": "{{context.userMessage.content.text}}"
            }
          },
          {
            "next": "iphone-pk",
            "type": "contains",
            "value": "iphone|i phone|ifon|i fon|aios|ios|i os|apol|apel|apple|mac|aifon|aiphone|aifone|üì±",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "iphone-pk",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Sigue las instrucciones de la imagen  üìç"
            }
          },
          {
            "type": "image",
            "value": {
              "url": "https://b2c-images-bucket.s3.ca-central-1.amazonaws.com/UX/ios_generico.png",
              "caption": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|men√∫|regresar|at√°s|atras|iniciar|regrezar|volver|empezar",
            "variable_replace": {}
          },
          {
            "next": "get-branch-pickup",
            "type": "format",
            "value": "location",
            "variable_replace": {
              "userLocation": "{{context.userMessage.content.text}}"
            }
          },
          {
            "next": "android-pk",
            "type": "contains",
            "value": "android|androide|samsung|samsun|huawei|guawei|motorola|alcatel|lg|zte|sony|xiaomi|xhaomi|shaomi|chiaomi|ü§ñ",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "sistema-pk-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "ü§î No creo haberte entendido... "
            }
          },
          {
            "type": "text",
            "value": {
              "text": "¬øMe repites tu respuesta?\n\n1Ô∏è‚É£ Android\n2Ô∏è‚É£ iOS (iPhone)"
            }
          }
        ],
        "transitions": [
          {
            "next": "android-pk",
            "type": "contains",
            "value": "1|uno|one|onu|1Ô∏è‚É£|android|androide|samsung|samsun|huawei|guawei|motorola|alcatel|lg|zte|sony|xiaomi|xhaomi|shaomi|chiaomi|ü§ñ",
            "variable_replace": {}
          },
          {
            "next": "iphone-pk",
            "type": "contains",
            "value": "2|dos|two|2Ô∏è‚É£|dous|iphone|i phone|ifon|i fon|aios|ios|i os|apol|apel|apple|mac|aifon|aiphone|aifone|üì±",
            "variable_replace": {}
          },
          {
            "next": "get-branch-pickup",
            "type": "format",
            "value": "location",
            "variable_replace": {
              "userLocation": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "invalid-location",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Lo siento, no encontr√© un restaurante cercano a esa direcci√≥n, pero podemos intentarlo de nuevo üòâ\nEnv√≠ame la ubicaci√≥n desde tu celular üì≤"
            }
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "men√∫|menu|regresar|atr√°s|atras|cambiar|me equivoque|otro|otra|llevar|para llevar|regreso",
            "variable_replace": {}
          },
          {
            "next": "get-branch-pickup",
            "type": "format",
            "value": "location",
            "variable_replace": {
              "userLocation": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "show-address-pickup",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Estas son las opciones m√°s cercanas a tu ubicaci√≥n: \n{{#each selectedBranch}} \n*{{position}}.üìç: {{name}}*\nüöò Est√°s a {{distance}}  km. de distancia. Con un recorrido de {{duration}} minutos.\nüó∫ https://www.google.com/maps/search/?api=1&query={{location.lat}},{{location.lng}}\n{{/each}}"
            }
          },
          {
            "type": "text",
            "value": {
              "text": "Elige el *n√∫mero* del lugar al que quieres ir a recoger tu orden. üî¢"
            }
          }
        ],
        "transitions": [
          {
            "next": "script-select-restaurant",
            "type": "regex",
            "value": "^[1-20]$",
            "variable_replace": {
              "addresSelect": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "script-select-restaurant",
        "content": [],
        "transitions": [],
        "transition_delay": 0
      },
      {
        "key": "show-address-pickup-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Disculpa, no comprend√≠ la direcci√≥n, escr√≠beme *el n√∫mero* del lugar al que quieres ir a recoger tu orden. üî¢\n\nSi tienes alg√∫n inconveniente escribe la palabra *ayuda* para que uno de mis compa√±eros de servicio al cliente te pueda ayudar."
            }
          }
        ],
        "transitions": [
          {
            "next": "script-select-restaurant",
            "type": "regex",
            "value": "^[1-20]$",
            "variable_replace": {
              "addresSelect": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "error-restaurant",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Disculpa, no encontr√© una sucursal cercana a la ubicaci√≥n que me compartiste. ü§î"
            }
          }
        ],
        "transitions": [
          {
            "next": "error-pickup",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "selected-store-pickup",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°Listo! *San Mart√≠n {{selectedBranchValid.name}}* te estar√° preparando tu pedido. ü§©"
            }
          }
        ],
        "transitions": [
          {
            "next": "get-webview-parameters",
            "variable_replace": {}
          }
        ],
        "transition_delay": 2
      },
      {
        "key": "error-pickup",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "S√≠ ‚úÖ"
                },
                {
                  "id": "string",
                  "title": "Men√∫"
                }
              ],
              "bodyText": "¬øDeseas intentar ingresar una ubicaci√≥n nuevamente? \n\nSelecciona la palabra *s√≠* para volver a intentar o selecciona *men√∫* para regresar al inicio.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "get-location-pickup",
            "type": "contains",
            "value": "si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|1|uno|one|va",
            "variable_replace": {}
          },
          {
            "next": "menu",
            "type": "contains",
            "value": "men√∫|menu|regresar|inicio|inisio|regrezar|salir|empezar|comienzo|principio|pedir|ordenar|opciones",
            "variable_replace": {}
          },
          {
            "next": "get-branch-pickup",
            "type": "format",
            "value": "location",
            "variable_replace": {
              "userLocation": ""
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "error-customer",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Oh oh! ¬°Parece que no he encontrado datos registrados! üòß\n\nPero no te preocupes, a continuaci√≥n puedes realizarlo..."
            }
          }
        ],
        "transitions": [
          {
            "next": "new-user",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "error-check",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Men√∫"
                },
                {
                  "id": "string",
                  "title": "Direcci√≥n nueva"
                }
              ],
              "bodyText": "Lo lamento, parece que ocurri√≥ un error al verificar tus datos. Si deseas volver al inicio selecciona *Men√∫.*",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|inicio|regresar|comenzar",
            "variable_replace": {}
          },
          {
            "next": "new-addresess",
            "type": "contains",
            "value": "direcci√≥n nueva|direccion nueva|nueva|new adress",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "get-location-pickup-DISABLED",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "{{#ifEquals context.deliveryMethod 'pickup'}}\nComp√°rteme tu ubicaci√≥n actual o la ubicaci√≥n donde deseas recoger tu pedido. üìç Esto es para verificar que cuentes con cobertura. üòâ{{else}}Comp√°rteme tu ubicaci√≥n actual. üìç {{/ifEquals}}\n\n_*Recuerda* que s√≥lo puedes compartir tu ubicaci√≥n desde el celular. üì≤_"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Tutorial"
                }
              ],
              "bodyText": "Si tienes duda de c√≥mo enviar tu ubicaci√≥n, selecciona la palabra *tutorial* y con gusto te muestro. üòä",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [],
        "transition_delay": -1
      },
      {
        "key": "before-bye",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Muy bien, aqu√≠ estar√© si tienes alguna consulta. üòä"
            }
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "get-address-reference-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Ingresa nuevamente tu direcci√≥n, asegur√°ndote de usar entre *5 y 100 caracteres*.\n\n_Un texto m√°s corto puede ayudarnos a ubicarte con mayor facilidad._ üôåüèª"
            }
          }
        ],
        "transitions": [
          {
            "next": "get-address-reference",
            "type": "contains",
            "value": "est√∫pida|estupida|in√∫til|inutil|perra|zorra|cabrona|pendeja|bruta|burra|mula|cerota|puta|idiota|cabron|pendejo|cabr√≥n|chinga|chingan|chingas|chingon|chingada|chingadas|jode|jodes|jodidos|jodiendo|jodo|kulero|mamadas|mames|mams|mam√≥n|mierda|mierda|mierdas|ni madres|pendeja|pendeja|pendejas|pendejo|pendejo|pendejos|pinche|pinches|ptm|puta|puta|putos|hdp|culero|putero|fuck|asshole|rateros|ratas|joto|joterias|joter√≠as|caca|kaka|cagado|cagados|idiota|esperma|sperma|vagina|menstruaci√≥n|sexo|pucha|puchita|panocha|panochon|nepe|pito|pitos|pitero|putero|putas|puterias|puter√≠as|puto|ratas|shinga|shingas|shingon|shing√≥n|shit|spm|verga|hdp|cagar|cagas|chinga|chingas|chingada|chingado|chingadoo|chingalos|chingao|chingaos|chingar|chingarlos|chingarnos|chingarte|chingate|chingatelos|chingo|chingon|chinguen|ching√≥n|ch√≠ngalos|ch√≠ngate|ch√≠ngatelos|orgullo.com|condon|condones|cond√≥n|cojon|coj√≥n|culera|culeras|culero|culeros|culo|joder|madrear|mamada|mamadas|mamar|mamarracho|mamen|mames|mamez|mamon|mam√≥n|maricon|maric√≥n|mierda|mojon|moj√≥n|ogete|ogetes|ojete|ojetes|pedorro|pendeja|pendejada|pendejadas|pendejas|pendejo|pinche|pinches|pinga|pito|pitos|puta|putas|putisima|putisimas|putisimo|putisimos|puto|putos|put√≠sima|put√≠simas|put√≠simo|put√≠simos|pu√±al|pu√±ales|pu√±etas|pu√±eta|shingaa|putazo|pendejo|pendeja|pendejos|pendejotes|pendejas|chingado|cabron|chinga|culera|mamar|mamen|kabron|jodido|pinches|pito|ratas|marika|rreputa|reputisima|cerote|punal|joder|idiota|estupido|est√∫pido|mierda|putos|porno|nudes|desnudo|desnudos|pendejos|torpe|tonto|mamar|chingada|malditos|maldito|pendejos|tarado|masturbar|masturbando|masturbaci√≥n|masturbacion|masturbasion|marturbame|mast√∫rbame|masturvando|masturvar|masturb√°ndome|masturvandome|chaqueta|chaqueteando|jalando|jal√°ndomela|jalandomela|masturbandome|pajiando|pajas|paja|mestruar|menstruacion|menstruaci√≥n|menstruasion|menstruasi√≥n|tengo la regla|me vino|me vine|sexo|sexual|porno|coger|cojer|cogida|cojida|semen|pene|culo|culos|ano|nalga|nalgas|seno|senos|chiche|chiches|chichi|chichis|pechos|tetas|teta|caca|orinar|fisting",
            "variable_replace": {}
          },
          {
            "next": "confirm-address-reference",
            "type": "regex",
            "value": "^([A-Z√°√©√≠√≥√∫√Å√â√ç√ì√ö√±√ëa-z√Ä-√ø0-9\\s\\,\\.\\#\\-\\_\\+\\;\\:\\&\\*\\=]|(¬©|¬Æ|[‚ÄÄ-„åÄ]|ÔøΩ[ÌÄÄ-ÔøΩ]|ÔøΩ[ÌÄÄ-ÔøΩ]|ÔøΩ[ÌÄÄ-ÔøΩ])){15,120}$",
            "variable_replace": {
              "addressReference": "{{context.userMessage.content.text}}"
            }
          },
          {
            "next": "confirm-address-reference",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "new-user",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°Perfecto! ‚ú®"
            }
          }
        ],
        "transitions": [
          {
            "position": 0,
            "type": "auto",
            "delay": 0,
            "variable_replace": {},
            "next": "user-name"
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "user-name",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Antes de continuar, ind√≠came s√≥lo tu *nombre completo* para iniciar tu pedido. üòâ \n\n_(Ejemplo: Bruce Wayne)_"
            }
          }
        ],
        "transitions": [
          {
            "type": "auto",
            "position": 0,
            "variable_replace": {
              "userEmail": "",
              "userFullName": ""
            }
          },
          {
            "position": 1,
            "type": "regex",
            "value": "^(cerote|puta|idiota|est√∫pido|estupido|hijo de puta|indio|negro|chino|covid|coronavi|covid-19|coronavirus|navirus|donald trump|AMLO|Pe√±a Nieto|peje|Queso Plas|Rosa Melano|Susana Horia|Benito Camela|Elba Ginon|Elvis Tek|Aquiles Bailo|Susana Distancia|Mama Dora|Zacarias Leche|Carmelo Machuca|Miguel Ambes Parada|Meardel Peson|Lalo Onganiza|Carmelo Tallas|Zacarias Blanco|Aquiles Pico|Marisa Caleche|Carmela Rosas|Willy Melano|Zacarias Bello Delano|Zoyla Alegria Delano|Ana Lisa Melchotto|Memo Herdez|Virginia Del Hoyo Aguado|Zoyla cerda|Deborah Vergara|Lucio Elano|Mar√≠a Melo Machuca|Paca Gartela|Pachin Gartela|Maite Lometo|Rosa Melgorro|Esther Colero|Paco Gerlo|Elver Galarga|Dora Melcacho|Zoyla Vaca|Alberto Catetas|Paco Mermela|Alberto Caco√±os|Alberto Caculos|Alberto Capollas|Alberto Capitos|Deborah Melculo|Abraham Melculo|Elsa Pito|Paco Mermela|Cindy Nero|Alma Marcela Goza de Alegria|Jony Melavo|Elba Gina|Paco Jerte|Rosamel Delgado|Edgar Ganta|Lola Meraz|Olga Disima de Loyo|Omar Icon|Larry Ca√±onga|Benito Camelo|Lola Mento|Alex Cremento|Ana Busado Dehesa|Ana Tom√≠a|Andres Tresado|Cindy Entes|Eddy Ficio|Elba Tracio|Elena Nito|Elmer Kado|Elmer cado|Elsa Nitario|Elsa Pato|Elton Tito|Elvio Lado|Elvio Lento|Elvis Cocho|Ema Amado Bustos|Alma Madero|Debora Testa|Rosa Melcacho|Alberto Catesta|Yotoko Turaja|Aquiles Castro|Sacarias Flores del Campo|Dolores Delano|Mela Halo|Casimiro Lateta|Ricopene|Rico Pene|Rosa Melaverga|Queso Badota|Quesobadota|Queso Vadota|Quesovadota)$",
            "variable_replace": {},
            "next": "user-name-fallback"
          },
          {
            "position": 2,
            "type": "regex",
            "value": "^([A-Za-z][√°√©√≠√≥√∫√Å√â√ç√ì√ö√±√ëa-z]{2,20}\\s?\\b){2,3}$",
            "variable_replace": {
              "userFullName": "{{context.userMessage.content.text}}"
            },
            "next": "script-separate-name"
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "user-lastname",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Ahora, ind√≠came tu *apellido*. _(Ej: Mart√≠nez)_"
            }
          }
        ],
        "transitions": [
          {
            "next": "user-lastname-fallback",
            "type": "contains",
            "value": "cerote|puta|idiota|est√∫pido|estupido|hijo de puta|indio|negro|chino|covid|coronavi|covid-19|coronavirus|navirus|donald trump|AMLO|Pe√±a Nieto|peje|Queso Plas|Rosa Melano|Susana Horia|Benito Camela|Elba Ginon|Elvis Tek|Aquiles Bailo|Susana Distancia|Mama Dora|Zacarias Leche|Carmelo Machuca|Miguel Ambes Parada|Meardel Peson|Lalo Onganiza|Carmelo Tallas|Zacarias Blanco|Aquiles Pico|Marisa Caleche|Carmela Rosas|Willy Melano|Zacarias Bello Delano|Zoyla Alegria Delano|Ana Lisa Melchotto|Memo Herdez|Virginia Del Hoyo Aguado|Zoyla cerda|Deborah Vergara|Lucio Elano|Mar√≠a Melo Machuca|Paca Gartela|Pachin Gartela|Maite Lometo|Rosa Melgorro|Esther Colero|Paco Gerlo|Elver Galarga|Dora Melcacho|Zoyla Vaca|Alberto Catetas|Paco Mermela|Alberto Caco√±os|Alberto Caculos|Alberto Capollas|Alberto Capitos|Deborah Melculo|Abraham Melculo|Elsa Pito|Paco Mermela|Cindy Nero|Alma Marcela Goza de Alegria|Jony Melavo|Elba Gina|Paco Jerte|Rosamel Delgado|Edgar Ganta|Lola Meraz|Olga Disima de Loyo|Omar Icon|Larry Ca√±onga|Benito Camelo|Lola Mento|Alex Cremento|Ana Busado Dehesa|Ana Tom√≠a|Andres Tresado|Cindy Entes|Eddy Ficio|Elba Tracio|Elena Nito|Elmer Kado|Elmer cado|Elsa Nitario|Elsa Pato|Elton Tito|Elvio Lado|Elvio Lento|Elvis Cocho|Ema Amado Bustos|Alma Madero|Debora Testa|Rosa Melcacho|Alberto Catesta|Yotoko Turaja|Aquiles Castro|Sacarias Flores del Campo|Dolores Delano|Mela Halo|Casimiro Lateta|Ricopene|Rico Pene|Rosa Melaverga|Queso Badota|Quesobadota|Queso Vadota|Quesovadota",
            "variable_replace": {}
          },
          {
            "next": "ask-email",
            "type": "regex",
            "value": "^(([A-Za-z√Ä-√ø]|(¬©|¬Æ|[‚ÄÄ-„åÄ]|ÔøΩ[ÌÄÄ-ÔøΩ]|ÔøΩ[ÌÄÄ-ÔøΩ]|ÔøΩ[ÌÄÄ-ÔøΩ])){1,}\\s?){1,}\\s?((¬©|¬Æ|[‚ÄÄ-„åÄ]|ÔøΩ[ÌÄÄ-ÔøΩ]|ÔøΩ[ÌÄÄ-ÔøΩ]|ÔøΩ[ÌÄÄ-ÔøΩ])*\\s*)?$",
            "variable_replace": {
              "userLastname": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "user-name-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "No reconozco ese nombre. ü§î ¬øPodr√≠as intentarlo de nuevo?"
            }
          },
          {
            "type": "text",
            "value": {
              "text": "Escribe tu *nombre completo*.  \n\n_(Ejemplo: Mar√≠a Gutierrez)_"
            }
          }
        ],
        "transitions": [
          {
            "next": "user-name-fallback",
            "type": "contains",
            "value": "cerote|puta|idiota|est√∫pido|estupido|hijo de puta|indio|negro|chino|covid|coronavi|covid-19|coronavirus|navirus|donald trump|AMLO|Pe√±a Nieto|peje|Queso Plas|Rosa Melano|Susana Horia|Benito Camela|Elba Ginon|Elvis Tek|Aquiles Bailo|Susana Distancia|Mama Dora|Zacarias Leche|Carmelo Machuca|Miguel Ambes Parada|Meardel Peson|Lalo Onganiza|Carmelo Tallas|Zacarias Blanco|Aquiles Pico|Marisa Caleche|Carmela Rosas|Willy Melano|Zacarias Bello Delano|Zoyla Alegria Delano|Ana Lisa Melchotto|Memo Herdez|Virginia Del Hoyo Aguado|Zoyla cerda|Deborah Vergara|Lucio Elano|Mar√≠a Melo Machuca|Paca Gartela|Pachin Gartela|Maite Lometo|Rosa Melgorro|Esther Colero|Paco Gerlo|Elver Galarga|Dora Melcacho|Zoyla Vaca|Alberto Catetas|Paco Mermela|Alberto Caco√±os|Alberto Caculos|Alberto Capollas|Alberto Capitos|Deborah Melculo|Abraham Melculo|Elsa Pito|Paco Mermela|Cindy Nero|Alma Marcela Goza de Alegria|Jony Melavo|Elba Gina|Paco Jerte|Rosamel Delgado|Edgar Ganta|Lola Meraz|Olga Disima de Loyo|Omar Icon|Larry Ca√±onga|Benito Camelo|Lola Mento|Alex Cremento|Ana Busado Dehesa|Ana Tom√≠a|Andres Tresado|Cindy Entes|Eddy Ficio|Elba Tracio|Elena Nito|Elmer Kado|Elmer cado|Elsa Nitario|Elsa Pato|Elton Tito|Elvio Lado|Elvio Lento|Elvis Cocho|Ema Amado Bustos|Alma Madero|Debora Testa|Rosa Melcacho|Alberto Catesta|Yotoko Turaja|Aquiles Castro|Sacarias Flores del Campo|Dolores Delano|Mela Halo|Casimiro Lateta|Ricopene|Rico Pene|Rosa Melaverga|Queso Badota|Quesobadota|Queso Vadota|Quesovadota",
            "variable_replace": {}
          },
          {
            "next": "script-separate-name",
            "type": "regex",
            "value": "^([A-Za-z][√°√©√≠√≥√∫√Å√â√ç√ì√ö√±√ëa-z]{2,20}.?\\s?\\b){1,4}",
            "variable_replace": {
              "userFullName": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "ask-email",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Excelente üôåüèª"
            }
          },
          {
            "type": "button",
            "value": {
              "footerText": "Si no cuentas con uno elige continuar üòâ",
              "buttons": [
                {
                  "id": "1975059d-bc00-4b10-9413-80fc713f3a5e",
                  "title": "Continuar"
                }
              ]
            },
            "caption": "Escr√≠beme tu *correo electr√≥nico*.  üìß"
          }
        ],
        "transitions": [
          {
            "position": 0,
            "type": "regex",
            "value": "^(continuar|Continuar|no tengo|sin correo)$",
            "next": "print-user-data"
          },
          {
            "position": 1,
            "type": "regex",
            "value": "^[A-Za-z0-9._%+-]+@[A-Za-z0-9-]+(\\.[A-Za-z]{2,})+$",
            "variable_replace": {
              "userEmail": "{{context.userMessage.content.text}}"
            },
            "next": "print-user-data"
          },
          {
            "position": 2,
            "type": "regex",
            "value": "^(no tengo|no|nely|nelly|√±o|norton|noo|nop|nah|no se|no s√©|no me lo s√©|no me lo se)$",
            "variable_replace": {
              "userEmail": ""
            },
            "next": "dont-have-email"
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "user-lastname-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Ahora, ind√≠came tu *apellido*. _(Ej: Mart√≠nez)_"
            }
          }
        ],
        "transitions": [
          {
            "next": "user-lastname-fallback",
            "type": "contains",
            "value": "cerote|puta|idiota|est√∫pido|estupido|hijo de puta|indio|negro|chino|covid|coronavi|covid-19|coronavirus|navirus|donald trump|AMLO|Pe√±a Nieto|peje|Queso Plas|Rosa Melano|Susana Horia|Benito Camela|Elba Ginon|Elvis Tek|Aquiles Bailo|Susana Distancia|Mama Dora|Zacarias Leche|Carmelo Machuca|Miguel Ambes Parada|Meardel Peson|Lalo Onganiza|Carmelo Tallas|Zacarias Blanco|Aquiles Pico|Marisa Caleche|Carmela Rosas|Willy Melano|Zacarias Bello Delano|Zoyla Alegria Delano|Ana Lisa Melchotto|Memo Herdez|Virginia Del Hoyo Aguado|Zoyla cerda|Deborah Vergara|Lucio Elano|Mar√≠a Melo Machuca|Paca Gartela|Pachin Gartela|Maite Lometo|Rosa Melgorro|Esther Colero|Paco Gerlo|Elver Galarga|Dora Melcacho|Zoyla Vaca|Alberto Catetas|Paco Mermela|Alberto Caco√±os|Alberto Caculos|Alberto Capollas|Alberto Capitos|Deborah Melculo|Abraham Melculo|Elsa Pito|Paco Mermela|Cindy Nero|Alma Marcela Goza de Alegria|Jony Melavo|Elba Gina|Paco Jerte|Rosamel Delgado|Edgar Ganta|Lola Meraz|Olga Disima de Loyo|Omar Icon|Larry Ca√±onga|Benito Camelo|Lola Mento|Alex Cremento|Ana Busado Dehesa|Ana Tom√≠a|Andres Tresado|Cindy Entes|Eddy Ficio|Elba Tracio|Elena Nito|Elmer Kado|Elmer cado|Elsa Nitario|Elsa Pato|Elton Tito|Elvio Lado|Elvio Lento|Elvis Cocho|Ema Amado Bustos|Alma Madero|Debora Testa|Rosa Melcacho|Alberto Catesta|Yotoko Turaja|Aquiles Castro|Sacarias Flores del Campo|Dolores Delano|Mela Halo|Casimiro Lateta|Ricopene|Rico Pene|Rosa Melaverga|Queso Badota|Quesobadota|Queso Vadota|Quesovadota",
            "variable_replace": {}
          },
          {
            "next": "ask-email",
            "type": "regex",
            "value": "^(([A-Za-z√Ä-√ø]|(¬©|¬Æ|[‚ÄÄ-„åÄ]|ÔøΩ[ÌÄÄ-ÔøΩ]|ÔøΩ[ÌÄÄ-ÔøΩ]|ÔøΩ[ÌÄÄ-ÔøΩ])){1,}\\s?){1,}\\s?((¬©|¬Æ|[‚ÄÄ-„åÄ]|ÔøΩ[ÌÄÄ-ÔøΩ]|ÔøΩ[ÌÄÄ-ÔøΩ]|ÔøΩ[ÌÄÄ-ÔøΩ])*\\s*)?$",
            "variable_replace": {
              "userLastname": "{{context.userMessage.content.text}}"
            }
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "print-user-data",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬øSon correctos tus datos?\n\nNombre: *{{context.userFullName}}*\n{{#if context.userEmail}}Correo electr√≥nico: *{{context.userEmail}}*{{/if}}"
            }
          },
          {
            "type": "button",
            "value": {
              "footerText": "",
              "buttons": [
                {
                  "id": "8a39c6d2-f801-4fb4-a54f-a8da96952134",
                  "title": "S√≠ ‚úÖ"
                },
                {
                  "id": "e675ff6d-5393-43cb-a3a9-011ed0b92448",
                  "title": "No üö´"
                }
              ]
            },
            "caption": "Selecciona *s√≠* para confirmar o selecciona *no* para editar los datos."
          }
        ],
        "transitions": [
          {
            "position": 0,
            "type": "regex",
            "value": "^(S√≠ ‚úÖ|si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|1|uno|one|va)$",
            "variable_replace": {},
            "next": "script-save-data-register"
          },
          {
            "position": 1,
            "type": "regex",
            "value": "^(No üö´|no|nel|no!|nely|nelly|√±o|norton|negativo|malo|malo|mal|incorrecto|incorrecta|equivocado|equivocada|negative|bad|wrong|not|nay|√±ao|ruim|errado|incorreto)$",
            "variable_replace": {},
            "next": "user-name"
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "dont-have-email",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Continuar"
                }
              ],
              "bodyText": "Muy bien, presiona *Continuar* para seguir tu pedido. üòâ",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "print-user-data",
            "type": "contains",
            "value": "continuar|Continuar|no tengo|sin correo",
            "variable_replace": {}
          },
          {
            "next": "print-user-data",
            "type": "regex",
            "value": "^[A-Za-z0-9._%+-+-']+@[A-Za-z0-9.-]+\\.[A-Za-z]+$",
            "variable_replace": {
              "userEmail": "{{context.userMessage.content.text}}"
            }
          },
          {
            "next": "dont-have-email",
            "type": "contains",
            "value": "no tengo|no|nely|nelly|√±o|norton|noo|nop|nah|no se|no s√©|no me lo s√©|no me lo se",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "ask-email-fallback",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Parece que no es el formato correcto, escr√≠belo nuevamente. _(Ejemplo: correo@sanmartin.com)_\n\nSi no cuentas con correo electr√≥nico escribe *continuar*. üòâ"
            }
          }
        ],
        "transitions": [
          {
            "next": "print-user-data",
            "type": "contains",
            "value": "continuar|Continuar|no tengo|sin correo",
            "variable_replace": {}
          },
          {
            "next": "print-user-data",
            "type": "regex",
            "value": "^[A-Za-z0-9._%+-+-']+@[A-Za-z0-9.-]+\\.[A-Za-z]+$",
            "variable_replace": {
              "userEmail": "{{context.userMessage.content.text}}"
            }
          },
          {
            "next": "dont-have-email",
            "type": "contains",
            "value": "no tengo|no|nely|nelly|√±o|norton|noo|nop|nah|no se|no s√©|no me lo s√©|no me lo se",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "confirm-user-data-fallback",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "S√≠ ‚úÖ"
                },
                {
                  "id": "string",
                  "title": "No ‚ùå"
                }
              ],
              "bodyText": "Estamos a un paso de terminar. üòâ ¬øMe repites si tu nombre es correcto? ",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "set-order-type",
            "type": "contains",
            "value": "si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|1|uno|one|va",
            "variable_replace": {}
          },
          {
            "next": "user-name",
            "type": "contains",
            "value": "no|nel|no!|nely|nelly|√±o|norton|negativo|malo|malo|mal|incorrecto|incorrecta|equivocado|equivocada|negative|bad|wrong|not|nay|√±ao|ruim|errado|incorreto",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "script-save-data-register",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "<<SAVE DATA REGISTER>>"
            }
          }
        ],
        "transitions": [
          {
            "next": "",
            "type": "script",
            "delay": 0,
            "params": {
              "params": {
                "attributes": {
                  "fullName": "userFullName",
                  "lastName": "lastName",
                  "firstName": "firstName",
                  "userEmail": "userEmail"
                }
              },
              "script": "yumpii-bot-middleware-prod-saveCustomerData",
              "transitions": {
                "success": "set-order-type",
                "error": "error-save-data"
              }
            }
          }
        ],
        "transition_delay": 1
      },
      {
        "key": "script-separate-name",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "<<SCRIPT SEPARATE NAME>>"
            }
          }
        ],
        "transitions": [
          {
            "next": "ask-email",
            "type": "script",
            "delay": 0,
            "params": {
              "params": {
                "method": "POST",
                "body": {
                  "code": "function split(s, delimiter) {\n  return s.split(delimiter);\n}\n\nfunction separateName() {\n  const name = context.userFullName;\n  let lastName = \"\";\n\n  const fullName = split(name, \" \");\n  let init = true;\n\n  for (const part of fullName) {\n    if (init) {\n      context.set(\"firstName\", part);\n      init = false;\n    } else {\n      lastName = lastName === \"\" ? part : `${lastName} ${part}`;\n    }\n  }\n\n  context.set(\"lastName\", lastName);\n  context.set(\"nextStep\", 131);\n}\n\ntry {\n  separateName();\n} catch (err) {\n  context.set(\"nextStep\", 139);\n}\n",
                  "transitions": {
                    "success": "ask-email",
                    "error": "error-separate",
                    "ask-email": "ask-email",
                    "error-separate": "error-separate"
                  }
                },
                "headers": {},
                "endpoint": "https://lqiduilpni.execute-api.us-east-1.amazonaws.com/dev/executeScript",
                "appendContext": true,
                "appendProfile": true
              },
              "script": "yumpii-bot-middleware-prod-executeEndpoint"
            }
          }
        ],
        "transition_delay": 1
      },
      {
        "key": "error-separate",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°Tuve un error en el sistema! üòµ‚Äçüí´"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "S√≠ quiero"
                },
                {
                  "id": "string",
                  "title": "Ahora no"
                },
                {
                  "id": "string",
                  "title": "Asesor"
                }
              ],
              "bodyText": "¬øQuieres ingresar tu nombre nuevamente?",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "user-name",
            "type": "contains",
            "value": "si|yes|ok|bueno|esta bien|afirmo|confirmo|confirmar|sipi|sip|shi|chi|1|uno|primera|primer|si!|¬°si!|sip|sipi|shi|chi|ti|se arma|orale|acuerdo|claro!|andale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|1|uno|one|va|si ‚úÖ|‚úÖsi|si quiero",
            "variable_replace": {}
          },
          {
            "next": "menu",
            "type": "contains",
            "value": "ahora no|no |regresar al menu",
            "variable_replace": {}
          },
          {
            "next": "business-hours",
            "type": "contains",
            "value": "asesor|agente|atencion al cliente",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "error-save-data",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Tuve un problema de conexi√≥n üòï intent√©moslo nuevamente por favor."
            }
          }
        ],
        "transitions": [
          {
            "next": "user-name",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "no-user-name",
        "content": [],
        "transitions": [],
        "transition_delay": 0
      },
      {
        "key": "registro-flow",
        "content": [],
        "transitions": [
          {
            "next": "script-separate-name2",
            "type": "flow",
            "value": "onResponse",
            "variable_replace": {}
          },
          {
            "next": "error-save-data",
            "type": "flow",
            "value": "onError",
            "variable_replace": {}
          },
          {
            "next": "confirm-user-data-fallback",
            "type": "flow",
            "value": "onIgnore",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "keyword-flow",
        "content": [],
        "transitions": [
          {
            "next": "registro-flow",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "script-separate-name2",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "type": "script",
            "params": {
              "params": {
                "code": "function Split(s, delimiter)\n    local result = {};\n    for match in (s..delimiter):gmatch(\"(.-)\"..delimiter) do\n        table.insert(result, match);\n    end\n    return result;\nend\n\nfunction separateName ()\n    userExtensionPayload = JSON.decode(Context.get(\"userExtensionPayload\"))\n    local name = userExtensionPayload.screen_0_Nombre_0\n    local lastName = \"\"\n    \n    local fullName = Split(name, \" \")\n    --Debug.print(fullName)\n    local init = true\n    for _, name in pairs(fullName) do\n        if init == true then\n            Context.set('firstName', name)\n            init = false\n        else\n            if lastName == \"\" then\n                lastName = name\n            else \n                lastName = lastName..\" \"..name\n            end\n        end\n    end\n    \n    Context.set('lastName', lastName)\n    Context.set(\"userFullName\", name)\n    Context.set(\"userEmail\", userExtensionPayload.screen_0_Correo_electrnico_1)\n    Workflow.branch(133) -- ask-email\nend\n\nlocal status, err = pcall(separateName)\n\nif (err) then\n   Debug.print(err)\n   Workflow.branch(139) -- error-separate\nend"
              },
              "script": "custom_script"
            }
          }
        ],
        "transition_delay": 1
      },
      {
        "key": "code-generate-link",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "type": "script",
            "params": {
              "params": {
                "code": "function generateMigoLink ()\n    getprivateKey = Context.get(\"privateKey\")\n    getpublicKey = Context.get(\"publicKey\")\n    baseUrl = Context.get(\"baseUrl_prod\")\n    slug = Context.get(\"slug\")\n    order = JSON.decode(Context.get('order'))\n    \n    --insert Table\n    -- al pasarle esto a HTTP.post el se encarga de hacerlo JSON.\n    body = {\n    \tprivateKey = getprivateKey,\n    \tpublicKey = getpublicKey,\n        amount = order.total,\n        userId = Input.getProfile().userId,\n        channel = \"wa\",\n        client = \"sanMartin\",\n        ads = {},\n    }\n       \n    -- Request:\n    result = HTTP.post(baseUrl, body)\n    Context.set('result', result)\n    --Debug.print(result)\n    if result.status == 201 then\n        Context.set(\"urlMigo\", result.data.URL)\n        Context.set(\"payment\", paymentObject)\n        --Workflow.branch(143) -- migo-payment-link\n    else\n        Workflow.branch(144) -- error-payment-link\n    end\nend\n\nlocal status, err = pcall(generateMigoLink)\n\nif (err) then\n    Debug.print(err)\n   Workflow.branch(144) -- error-payment-link\nend\n\n"
              },
              "script": "custom_script"
            }
          }
        ],
        "transition_delay": 1
      },
      {
        "key": "migo-payment-link",
        "content": [
          {
            "type": "url_button",
            "value": {
              "url": "{{context.urlMigo}}",
              "label": "Hacer pago",
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "bodyText": "Ingresa al siguiente bot√≥n de *Hacer pago* para poder realizar tu pago de forma segura. üòâ üí≥",
              "footerText": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "fallback-nuevo-link",
            "type": "contains",
            "value": "expirado|no aparece|no sirve|no puedo|expiro",
            "variable_replace": {}
          },
          {
            "next": "bh-migo",
            "type": "contains",
            "value": "regresar|atras|iniciar|regrezar|volver|empezar",
            "variable_replace": {}
          },
          {
            "next": "migo-payment-success",
            "type": "contains",
            "value": "skip payment",
            "variable_replace": {}
          },
          {
            "next": "migo-payment-fallback",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "error-payment-link",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "S√≠ ‚úÖ"
                },
                {
                  "id": "string",
                  "title": "No ‚ùå"
                },
                {
                  "id": "string",
                  "title": "Asesor"
                }
              ],
              "bodyText": "Ocurri√≥ un error al generar tu link de pago. ü§î",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "bh-migo",
            "type": "contains",
            "value": "si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|1|uno|one|1Ô∏è‚É£|va",
            "variable_replace": {}
          },
          {
            "next": "no-continue-payment",
            "type": "contains",
            "value": "2|dos|two|2Ô∏è‚É£|no|nel|no!|nely|nelly|√±o|norton|negativo|malo|malo|mal|incorrecto|incorrecta|equivocado|equivocada|negative|bad|wrong|not|nay|√±ao|ruim|errado|incorreto",
            "variable_replace": {}
          },
          {
            "next": "business-hours",
            "type": "contains",
            "value": "asesor |agente|ayuda",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "sendTo payment",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "type": "script",
            "params": {
              "params": {
                "code": "-- Get the webhook's payload\nlocal webhookData = Context.get(\"webhookPayload\", \"json\")\n\n-- Parse the response\npaymentObject = JSON.decode(webhookData)\n-- Debug.print(paymentObject)\nContext.set(\"payment\", paymentObject)\nContext.set(\"voucherUrl\", paymentObject.url)\nWorkflow.branch(paymentObject.state)"
              },
              "script": "custom_script"
            }
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "migo-payment-success",
        "content": [],
        "transitions": [
          {
            "next": "enviar-orden",
            "variable_replace": {}
          }
        ],
        "transition_delay": 2
      },
      {
        "key": "set-variable",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "code-generate-link",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "no-continue-payment",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Men√∫"
                }
              ],
              "bodyText": "Si te puedo apoyar en m√°s selecciona *Men√∫* para mostrarte las dem√°s opciones.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|men√∫|memu|inicio",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "migo-payment-declined",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Lo siento, parece que existe un problema con tu pago y fue rechazado."
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "S√≠ ‚úÖ"
                },
                {
                  "id": "string",
                  "title": "No ‚ùå"
                }
              ],
              "bodyText": "¬øLo quieres intentar de nuevo?",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "bh-migo",
            "type": "contains",
            "value": "si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|1|uno|one|1Ô∏è‚É£|va",
            "variable_replace": {}
          },
          {
            "next": "no-continue-payment",
            "type": "contains",
            "value": "2|dos|two|2Ô∏è‚É£|no|nel|no!|nely|nelly|√±o|norton|negativo|malo|malo|mal|incorrecto|incorrecta|equivocado|equivocada|negative|bad|wrong|not|nay|√±ao|ruim|errado|incorreto",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "migo-payment-error",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Tuvimos un fallo procesando tu pago. "
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "S√≠ ‚úÖ"
                },
                {
                  "id": "string",
                  "title": "No ‚ùå"
                },
                {
                  "id": "string",
                  "title": "Asesor"
                }
              ],
              "bodyText": "¬øDeseas intentarlo de nuevo?",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "bh-migo",
            "type": "contains",
            "value": "si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|1|uno|one|1Ô∏è‚É£|va",
            "variable_replace": {}
          },
          {
            "next": "no-continue-payment",
            "type": "contains",
            "value": "2|dos|two|2Ô∏è‚É£|no|nel|no!|nely|nelly|√±o|norton|negativo|malo|malo|mal|incorrecto|incorrecta|equivocado|equivocada|negative|bad|wrong|not|nay|√±ao|ruim|errado|incorreto",
            "variable_replace": {}
          },
          {
            "next": "business-hours",
            "type": "contains",
            "value": "asesore|asesor|agente|ayuda",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "expired-link",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "El link para realizar tu pago *expir√≥.*"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "S√≠ ‚úÖ"
                },
                {
                  "id": "string",
                  "title": "No ‚ùå"
                }
              ],
              "bodyText": "¬øDeseas que te env√≠e otro link?",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "bh-migo",
            "type": "contains",
            "value": "si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|1|uno|one|1Ô∏è‚É£|va",
            "variable_replace": {}
          },
          {
            "next": "no-continue-payment",
            "type": "contains",
            "value": "2|dos|two|2Ô∏è‚É£|no|nel|no!|nely|nelly|√±o|norton|negativo|malo|malo|mal|incorrecto|incorrecta|equivocado|equivocada|negative|bad|wrong|not|nay|√±ao|ruim|errado|incorreto",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "fallback-nuevo-link",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Estoy creando el nuevo link de pago. "
            }
          }
        ],
        "transitions": [
          {
            "next": "bh-migo",
            "variable_replace": {}
          }
        ],
        "transition_delay": 2
      },
      {
        "key": "PDF Voucher",
        "content": [],
        "transitions": [],
        "transition_delay": -1
      },
      {
        "key": "migo-payment-fallback",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "S√≠ ‚úÖ"
                },
                {
                  "id": "string",
                  "title": "No ‚ùå"
                }
              ],
              "bodyText": "¬øDeseas continuar con tu pago? üí≥",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "bh-migo",
            "type": "contains",
            "value": "si|si!|s√≠|s√≠!|¬°si!|¬°s√≠!|sip|sipi|shi|chi|ti|se arma|orale|√≥rale|acuerdo|claro!|andale|√°ndale|sale|vale|c√°mara|camara|muestrame|claro|por supuesto|bueno|vas|jalo|simon|sim√≥n|simona|simonkey|simonki|muy bien|ok|okay|oki|okey|va que va|ahuevo|que hay|a ver|zi|yes|yep|confirmo|confirmado|confirmar|1|uno|one|1Ô∏è‚É£|va",
            "variable_replace": {}
          },
          {
            "next": "no-continue-payment",
            "type": "contains",
            "value": "2|dos|two|2Ô∏è‚É£|no|nel|no!|nely|nelly|√±o|norton|negativo|malo|malo|mal|incorrecto|incorrecta|equivocado|equivocada|negative|bad|wrong|not|nay|√±ao|ruim|errado|incorreto",
            "variable_replace": {}
          },
          {
            "next": "fallback-nuevo-link",
            "type": "contains",
            "value": "expirado|no aparece|no sirve|no puedo|expiro",
            "variable_replace": {}
          },
          {
            "next": "no-continue-payment",
            "type": "contains",
            "value": "efectivo|cambiar|otro|regresar|otra|dinero|equivoque|atras|pago contra entrega|tarjeta contra entrega|contra entrega|tarjeta c/entrega",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "bh-migo",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Estoy generando tu link de pago...‚åõ"
            }
          }
        ],
        "transitions": [
          {
            "next": "set-variable",
            "type": "script",
            "params": {
              "params": {
                "body": {},
                "method": "POST",
                "headers": {},
                "endpoint": "https://d9rsao4hm4.execute-api.us-east-1.amazonaws.com/staging/business"
              },
              "script": "yumpii-bot-middleware-prod-executeEndpoint"
            },
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "migo-lock-payment",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Lo siento, pero llegaste al l√≠mite de intentos para realizar tu pago en l√≠nea. üò¨"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Men√∫"
                },
                {
                  "id": "string",
                  "title": "Asesor"
                }
              ],
              "bodyText": "Te puedo mostrar de nuevo el men√∫",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "cancelar-pedido-2",
            "type": "contains",
            "value": "cancelar pedido|cancelar orden|cancelar|canselar|cancel|cansel|ya no|yano|no quiero|ya no m√°s|no m√°s",
            "variable_replace": {}
          },
          {
            "next": "business-hours",
            "type": "contains",
            "value": "agente|asesor|persona|alguien real|atenci√≥n al cliente|alguien|humano|no robot|atencion|ayuda humana|ayuda",
            "variable_replace": {}
          },
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|inicio|regresar",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "cancelar-pedido-2",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Men√∫"
                }
              ],
              "bodyText": "Tu pedido ha sido cancelado, si puedo ayudarte con algo m√°s selecciona *Men√∫*.üòä",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "men√∫|menu|regresar|inicio|inisio|regrezar|salir|empezar|comienzo|principio|pedir|ordenar|opciones",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "payment-closed",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Lo siento, por ahora ya no se puede realizar tu pago. üò≥\n\n*Nuestro horario es de 7:00 a.m a 8:30 p.m.*"
            }
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "variable_replace": {}
          }
        ],
        "transition_delay": 2
      },
      {
        "key": "payment-anulado",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Tu pago fue *anulado* exitosamente ‚úÖ."
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Men√∫"
                }
              ],
              "bodyText": "Si quieres regresar al inicio, selecciona el bot√≥n *Men√∫*",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|inicio|regresar|comenzar",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "payment-sucess-migo",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "¬°Tu pago ha sido realizado con √©xito! ‚úÖ.\n\nTus datos de referencia son los siguientes:\n*Referencia:*  {{payment-success-migo.data.transaction.paymentData.referenceNumber}}\n*Autorizaci√≥n:*  {{payment-success-migo.data.transaction.paymentData.authorizationNumber}} "
            }
          }
        ],
        "transitions": [
          {
            "next": "bh-final-pedido",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "human-closed",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "En este momento nuestros agentes  est√°n fuera del horario de atenci√≥n. Te recordamos que *el horario de atenci√≥n es de lunes a domingo de 07:00am a 08:30pm.*"
            }
          }
        ],
        "transitions": [],
        "transition_delay": -1
      },
      {
        "key": "bh-final-pedido",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "human-intro-pedido-si",
            "type": "script",
            "params": {
              "params": {
                "body": {},
                "method": "POST",
                "headers": {},
                "endpoint": "https://d9rsao4hm4.execute-api.us-east-1.amazonaws.com/staging/business"
              },
              "script": "yumpii-bot-middleware-prod-executeEndpoint"
            },
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "human-intro-pedido-si",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "En este momento mis compa√±eros est√°n procesando tu orden üßëüèª‚Äçüíªüë©üèΩ‚Äçüíª\nEn breve te confirmar√°n."
            }
          }
        ],
        "transitions": [
          {
            "next": "human-loop",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "human-loop",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [],
        "transition_delay": -1
      },
      {
        "key": "Inicio KG",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Por favor, escribe tu consulta en un *solo mensaje*."
            }
          }
        ],
        "transitions": [
          {
            "next": "Knowledge Genie",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "Talk to Human",
        "content": [],
        "transitions": [
          {
            "next": "business-hours",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "Csat Talk to Human",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Ahora verifico la disponibilidad de mis compa√±eros... ‚è≥"
            }
          }
        ],
        "transitions": [
          {
            "next": "Talk to Human",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "Error",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Lamento no poderte ayudar, seguir√© aprendiendo. ‚òùüèº"
            }
          },
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Otra pregunta ‚ùì"
                },
                {
                  "id": "string",
                  "title": "Men√∫ ü•ñ"
                }
              ],
              "bodyText": "Si deseas puedes selecciona *otra pregunta* a continuaci√≥n o selecciona *Men√∫* para regresar al inicio.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "Go to Menu",
            "type": "contains",
            "value": "menu prinicpal|menu principal|menu|inicio|volver|regresar|inisio|volver|bolber|menuü•ñ|menu ü•ñ",
            "variable_replace": {}
          },
          {
            "next": "Inicio KG",
            "type": "contains",
            "value": "otra pregunta|otra|diferente|pregunta|consulta|duda|otra pregunta ‚ùì",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "Csat Go to Menu",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Otra pregunta ‚ùì"
                },
                {
                  "id": "string",
                  "title": "Men√∫ ü•ñ"
                }
              ],
              "bodyText": "Si deseas puedes selecciona *otra pregunta* a continuaci√≥n o selecciona *Men√∫* para regresar al inicio.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "Go to Menu",
            "type": "contains",
            "value": "menu prinicpal|menu principal|menu|inicio|volver|regresar|inisio|volver|bolber|menuü•ñ|menu ü•ñ",
            "variable_replace": {}
          },
          {
            "next": "Inicio KG",
            "type": "contains",
            "value": "otra pregunta|otra|diferente|pregunta|consulta|duda|otra pregunta ‚ùì",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "Go to Menu",
        "content": [],
        "transitions": [
          {
            "next": "menu",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "Csat Exit Genie",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Fue un gusto atenderte, te llevar√© nuevamente al men√∫ principal. üòä"
            }
          }
        ],
        "transitions": [
          {
            "next": "Go to Menu",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "Csat Question Solved",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Otra pregunta ‚ùì"
                },
                {
                  "id": "string",
                  "title": "Men√∫ ü•ñ"
                }
              ],
              "bodyText": "Si deseas puedes elige *otra pregunta* a continuaci√≥n o selecciona *Men√∫* para regresar al inicio.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "Go to Menu",
            "type": "contains",
            "value": "menu prinicpal|menu principal|menu|inicio|volver|regresar|inisio|volver|bolber|menuü•ñ|menu ü•ñ",
            "variable_replace": {}
          },
          {
            "next": "Inicio KG",
            "type": "contains",
            "value": "otra pregunta|otra|diferente|pregunta|consulta|duda|otra pregunta ‚ùì",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "Knowledge Genie",
        "content": [
          {
            "type": "text",
            "value": {
              "text": ""
            }
          }
        ],
        "transitions": [
          {
            "next": "Error",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "Csat",
        "content": [],
        "transitions": [
          {
            "next": "data-WA-Flows",
            "type": "flow",
            "value": "onResponse",
            "variable_replace": {}
          },
          {
            "next": "error-wf",
            "type": "flow",
            "value": "onError",
            "variable_replace": {}
          },
          {
            "next": "fallback-wf",
            "type": "flow",
            "value": "onIgnore",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "success-wf-csat",
        "content": [
          {
            "type": "text",
            "value": {
              "text": "Aqu√≠ comparto un resumen de tus respuestas. Muchas gracias por tu valioso tiempo üôèüèº\n\n\n{{#ifEquals experienceRate '0_good'}}\n- Experiencia: Buena\n- Raz√≥n: {{reasonSelectedWF}}{{/ifEquals}}\n{{#if OtherCommentGood}}\n- Comentario: {{OtherCommentGood}}\n{{/if}}\n{{#ifEquals experienceRate '1_bad'}}\n- Experiencia: Mala\n- Raz√≥n: {{reasonSelectedBadWF}}{{/ifEquals}}\n{{#if OtherCommentBad}}\n- Comentario: {{OtherCommentBad}}\n{{/if}}"
            }
          }
        ],
        "transitions": [
          {
            "next": "go-to-back-menu",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "fallback-wf",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Responder encuesta"
                },
                {
                  "id": "string",
                  "title": "Men√∫ inicial"
                }
              ],
              "bodyText": "Puedes seleccionar una opci√≥n para continuar",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|menu inicial|inicio",
            "variable_replace": {}
          },
          {
            "next": "Csat",
            "type": "contains",
            "value": "responder encueta|1|responder",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "error-wf",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Responder encuesta"
                },
                {
                  "id": "string",
                  "title": "Men√∫ inicial"
                }
              ],
              "bodyText": "Parece que sucedi√≥ un problema para comenzar la encuesta, ¬øDeseas vovler a intentar?",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "type": "contains",
            "value": "menu|menu incial|inicio|volver al inicio",
            "variable_replace": {}
          },
          {
            "next": "Csat",
            "type": "contains",
            "value": "responder encuesta|responder|encuesta",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      },
      {
        "key": "data-WA-Flows",
        "content": [],
        "transitions": [
          {
            "type": "script",
            "params": {
              "params": {
                "code": "local flowDataObj = Context.get (\"userExtensionPayload\", json)\n\nflowData = JSON.decode(flowDataObj)\n\nContext.set(\"experienceRate\", flowData.screen_0_Experience_01)\nContext.set(\"reasonSelected\", flowData.screen_0_Reason_02)\nContext.set(\"OtherCommentGood\", flowData.screen_0_Other_message1)\nContext.set(\"reasonSelectedBad\", flowData.screen_0_Reason_03)\nContext.set(\"OtherCommentBad\", flowData.screen_0_Other_message2)\n"
              },
              "script": "custom_script"
            }
          },
          {
            "next": "script-rename-options",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "script-rename-options",
        "content": [],
        "transitions": [
          {
            "type": "script",
            "params": {
              "params": {
                "code": "-- Funci√≥n para limpiar la variable reasonSelected\nlocal reasonSelectedWF = Context.get(\"reasonSelected\")\nlocal reasonSelectedBadWF = Context.get(\"reasonSelectedBad\")\n\n\n\nif reasonSelectedWF == \"0_easy\" then\n    reasonSelectedWF = \"Fue f√°cil entender c√≥mo funciona este chat\"\nelseif reasonSelectedWF == \"1_clearly\" then\n    reasonSelectedWF = \"La informaci√≥n que recib√≠ fue clara y me ayud√≥\"\nelseif reasonSelectedWF == \"2_other\" then\n    reasonSelectedWF = \"Otra\"\nend\n\nif reasonSelectedBadWF == \"0_Not_easy\" then\n    reasonSelectedBadWF = \"Fue dif√≠cil entender c√≥mo funciona este chat\"\nelseif reasonSelectedWF == \"1_Not_clearly \" then\n    reasonSelectedBadWF = \"La informaci√≥n que recib√≠ no me ayud√≥ a resolver mi necesidad\"\nelseif reasonSelectedWF == \"2_No_other\" then\n    reasonSelectedBadWF = \"Otra\"\nend\n\n\n-- Guardar los resultados en el contexto\nContext.set(\"reasonSelectedBadWF\", reasonSelectedBadWF)\nContext.set(\"reasonSelectedWF\", reasonSelectedWF)\n\n"
              },
              "script": "custom_script"
            }
          },
          {
            "next": "success-wf-csat",
            "variable_replace": {}
          }
        ],
        "transition_delay": 0
      },
      {
        "key": "go-to-back-menu",
        "content": [
          {
            "type": "button",
            "value": {
              "header": {
                "url": "",
                "text": "",
                "type": "text"
              },
              "buttons": [
                {
                  "id": "string",
                  "title": "Men√∫ principal"
                }
              ],
              "bodyText": "Si te puedo ayudar en algo m√°s, selecciona la palabra *Men√∫ principal* para regresar al inicio.",
              "footerText": ""
            },
            "caption": ""
          }
        ],
        "transitions": [
          {
            "next": "menu",
            "variable_replace": {}
          }
        ],
        "transition_delay": -1
      }
    ],
    "default": {
      "text": "Lo siento, no comprendo lo que me enviaste. üòî\nIntent√©moslo de nuevo o escribe *men√∫* para volver a comenzar..."
    },
    "globals": [
      {
        "keywords": [
          "menu",
          "men√∫",
          "restart",
          "comenzar",
          "reiniciar"
        ],
        "stateKey": "menu"
      },
      {
        "keywords": [
          "cabron",
          "chinga",
          "chingan",
          "chingas",
          "chingon",
          "chingada",
          "chingadas",
          "jode",
          "jodes",
          "jodidos",
          "jodiendo",
          "jodo",
          "kulero",
          "mamadas",
          "mames",
          "mams",
          "mamon",
          "mierda",
          "mierda",
          "mierdas",
          "nimadres",
          "pendeja",
          "pendeja",
          "pendejas",
          "pendejo",
          "pendejo",
          "pendejos",
          "pinche",
          "pinches",
          "ptm",
          "puta",
          "puta",
          "putos",
          "hdp",
          "culero",
          "putero",
          "fuck",
          "asshole",
          "rateros",
          "ratas",
          "joto",
          "joterias",
          "joterias",
          "caca",
          "kaka",
          "cagado",
          "cagados",
          "huevon",
          "huevones",
          "wevones",
          "webones",
          "webon",
          "wevon",
          "idiota",
          "esperma",
          "sperma",
          "vagina",
          "menstruacion",
          "sexo",
          "pucha",
          "puchita",
          "panocha",
          "panochon",
          "nepe",
          "pito",
          "pitos",
          "pitero",
          "putero",
          "putas",
          "puterias",
          "puterias",
          "puto",
          "ratas",
          "shinga",
          "shingas",
          "shingon",
          "shingon",
          "shit",
          "spm",
          "verga",
          "cagar",
          "cagas",
          "chinga",
          "chingas",
          "chingada",
          "chingado",
          "chingadoo",
          "chingalos",
          "chingao",
          "chingaos",
          "chingar",
          "chingarlos",
          "chingarnos",
          "chingarte",
          "chingate",
          "chingatelos",
          "chingo",
          "chingon",
          "chinguen",
          "chingon",
          "chingalos",
          "chingate",
          "chingatelos",
          "cancer",
          "cancer",
          "condon",
          "condones",
          "cond√≥n",
          "cojon",
          "cojon",
          "culera",
          "culeras",
          "culero",
          "culeros",
          "culo",
          "huebo",
          "huebos",
          "huevo",
          "huevos",
          "joder",
          "madrear",
          "mamada",
          "mamadas",
          "mamar",
          "mamarracho",
          "mamen",
          "mames",
          "mamez",
          "mamon",
          "mamon",
          "maricon",
          "mierda",
          "mojon",
          "ogete",
          "ogetes",
          "ojete",
          "ojetes",
          "pedorro",
          "pendeja",
          "pendejada",
          "pendejadas",
          "pendejas",
          "pendejo",
          "pinche",
          "pinches",
          "pinga",
          "pito",
          "pitos",
          "puta",
          "putas",
          "putisima",
          "putisimas",
          "putisimo",
          "putisimos",
          "puto",
          "putos",
          "putisima",
          "putisimas",
          "putisimo",
          "putisimos",
          "pu√±al",
          "pu√±ales",
          "pu√±etas",
          "pu√±eta",
          "shingaa",
          "webo",
          "webos",
          "wevo",
          "wevos",
          "putazo",
          "pendejo",
          "pendeja",
          "pendejos",
          "pendejotes",
          "pendejas",
          "chingado",
          "cabron",
          "chinga",
          "culera",
          "mamar",
          "mamen",
          "kabron",
          "jodido",
          "pinches",
          "pito",
          "ratas",
          "marika",
          "rreputa",
          "reputisima",
          "cerote",
          "punal",
          "joder",
          "idiota",
          "estupido",
          "estupido",
          "mierda",
          "putos",
          "porno",
          "nudes",
          "desnudo",
          "desnudos",
          "pendejos",
          "torpe",
          "tonto",
          "mamar",
          "chingada",
          "malditos",
          "maldito",
          "pendejos",
          "tarado",
          "masturbar",
          "masturbando",
          "masturbacion",
          "masturbacion",
          "masturbasion",
          "marturbame",
          "masturbame",
          "masturvando",
          "masturvar",
          "masturbandome",
          "masturvandome",
          "chaqueta",
          "chaqueteando",
          "jalando",
          "jalondomela",
          "jalandomela",
          "masturbandome",
          "pajiando",
          "pajas",
          "paja",
          "mestruar",
          "menstruacion",
          "menstruacion",
          "menstruasion",
          "menstruasion",
          "tengo la regla",
          "me vino",
          "me vine",
          "sexo",
          "sexual",
          "porno",
          "coger",
          "cojer",
          "cogida",
          "cojida",
          "semen",
          "pene",
          "culo",
          "culos",
          "ano",
          "nalga",
          "nalgas",
          "seno",
          "senos",
          "chiche",
          "chiches",
          "chichi",
          "chichis",
          "pechos",
          "tetas",
          "ubres",
          "teta",
          "caca",
          "orinar",
          "fisting",
          "tonta",
          "mensa",
          "pendeja",
          "wawis",
          "clitoris",
          "panocha",
          "bizcocho",
          "biscocho",
          "perra",
          "zorra",
          "chupamela",
          "gorda"
        ],
        "stateKey": "insult"
      },
      {
        "keywords": [
          "quien sos",
          "quienes son",
          "quien eres",
          "presentate",
          "diga quien es",
          "presentese"
        ],
        "stateKey": "identity"
      },
      {
        "keywords": [
          "ok",
          "esta bien",
          "perfecto",
          "alright",
          "oks",
          "oko",
          "okay",
          "okey",
          "ok ok"
        ],
        "stateKey": "ok"
      },
      {
        "keywords": [
          "gracias",
          "super",
          "orale",
          "grasias",
          "grazias",
          "graxs",
          "grax",
          "thank",
          "thanks",
          "gratzie",
          "thnks"
        ],
        "stateKey": "your-welcome"
      },
      {
        "keywords": [
          "amo como me tratas",
          "me encantan",
          "los amo",
          "amo",
          "me encanta el apartamento",
          "me gustan",
          "me gusta"
        ],
        "stateKey": "brand-love"
      },
      {
        "keywords": [
          "jaja",
          "jaj",
          "jajaja",
          "jaaa",
          "jajajaja",
          "ja",
          "chistoso",
          "que risa",
          "gracioso",
          "me diviertes",
          "wajaja",
          "kakaka",
          "kaka",
          "kakakaka",
          "jaajajaja",
          "jsjs",
          "jsjsjs"
        ],
        "stateKey": "laugh"
      },
      {
        "keywords": [
          "menu",
          "opciones",
          "regresar",
          "atras",
          "atas",
          "de nuevo",
          "volver",
          "donde estaba",
          "again",
          "intentar"
        ],
        "stateKey": "menu"
      },
      {
        "keywords": [
          "restart",
          "hola",
          "hello",
          "welcome",
          "buenas tardes",
          "que onda",
          "comenzar",
          "iniciar",
          "empezar",
          "empezat",
          "comenzar",
          "start",
          "play",
          "q onda",
          "comenza",
          "ola",
          "hi",
          "buena tarde",
          "buen dia",
          "morning",
          "buenos dias",
          "buena noche",
          "buenas noches"
        ],
        "stateKey": "welcome"
      }
    ],
    "business_hours": [
      {
        "key": "delivery",
        "schedules": [
          {
            "endTime": "23:59",
            "dateFrom": "2023-01-01T00:00:00-06:00",
            "weekDays": {
              "friday": true,
              "monday": true,
              "sunday": true,
              "tuesday": true,
              "saturday": true,
              "thursday": true,
              "wednesday": true
            },
            "startTime": "05:00",
            "dateThrough": "2100-12-31T23:59:59-06:00"
          }
        ],
        "fallbackStateKey": "bh-close"
      },
      {
        "key": "pickup",
        "schedules": [
          {
            "endTime": "23:00",
            "dateFrom": "2023-01-01T00:00:00-06:00",
            "weekDays": {
              "friday": true,
              "monday": true,
              "sunday": true,
              "tuesday": true,
              "saturday": true,
              "thursday": true,
              "wednesday": true
            },
            "startTime": "05:00",
            "dateThrough": "2100-12-31T23:59:59-06:00"
          }
        ],
        "fallbackStateKey": "business-hours-pickup-closed"
      }
    ]
  }
}